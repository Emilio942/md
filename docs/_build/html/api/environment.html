<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Environment Models &#8212; ProteinMD 1.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Analysis Tools" href="analysis.html" />
    <link rel="prev" title="Force Fields" href="forcefield.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="environment-models">
<h1>Environment Models<a class="headerlink" href="#environment-models" title="Link to this heading">¶</a></h1>
<p>The <code class="xref py py-mod docutils literal notranslate"><span class="pre">proteinMD.environment</span></code> module provides comprehensive environment models for molecular dynamics simulations, including explicit and implicit solvent models, periodic boundary conditions, and other environmental effects.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>The environment module includes:</p>
<ul class="simple">
<li><p><strong>Water Models</strong>: TIP3P explicit water model for realistic solvation</p></li>
<li><p><strong>Implicit Solvent</strong>: Generalized Born (GB) model for fast approximate solvation</p></li>
<li><p><strong>Periodic Boundary Conditions</strong>: PBC for bulk properties and realistic boundary effects</p></li>
<li><p><strong>Ion Models</strong>: Support for common ions (Na⁺, Cl⁻, K⁺, Mg²⁺)</p></li>
<li><p><strong>Membrane Models</strong>: Lipid bilayer models for membrane protein simulations</p></li>
<li><p><strong>Vacuum Simulations</strong>: Gas-phase simulations without solvent</p></li>
</ul>
</section>
<section id="quick-example">
<h2>Quick Example<a class="headerlink" href="#quick-example" title="Link to this heading">¶</a></h2>
<p>Basic solvation setup:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.water</span><span class="w"> </span><span class="kn">import</span> <span class="n">TIP3PWaterModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.periodic_boundary</span><span class="w"> </span><span class="kn">import</span> <span class="n">PeriodicBoundaryConditions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.structure.pdb_parser</span><span class="w"> </span><span class="kn">import</span> <span class="n">PDBParser</span>

<span class="c1"># Load protein</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">()</span>
<span class="n">protein</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;protein.pdb&quot;</span><span class="p">)</span>

<span class="c1"># Add explicit water</span>
<span class="n">water_model</span> <span class="o">=</span> <span class="n">TIP3PWaterModel</span><span class="p">()</span>
<span class="n">solvated_system</span> <span class="o">=</span> <span class="n">water_model</span><span class="o">.</span><span class="n">solvate_protein</span><span class="p">(</span>
    <span class="n">protein</span><span class="o">=</span><span class="n">protein</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>        <span class="c1"># 1.0 nm padding</span>
    <span class="n">ion_concentration</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>  <span class="c1"># 150 mM NaCl</span>
    <span class="n">neutralize</span><span class="o">=</span><span class="kc">True</span>     <span class="c1"># Neutralize system</span>
<span class="p">)</span>

<span class="c1"># Setup periodic boundaries</span>
<span class="n">pbc</span> <span class="o">=</span> <span class="n">PeriodicBoundaryConditions</span><span class="p">()</span>
<span class="n">pbc</span><span class="o">.</span><span class="n">setup_cubic_box</span><span class="p">(</span><span class="n">solvated_system</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solvated system: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">solvated_system</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span><span class="si">}</span><span class="s2"> atoms&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Water molecules: </span><span class="si">{</span><span class="n">water_model</span><span class="o">.</span><span class="n">count_water_molecules</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="module-proteinMD.environment.water">
<span id="explicit-water-models"></span><h2>Explicit Water Models<a class="headerlink" href="#module-proteinMD.environment.water" title="Link to this heading">¶</a></h2>
<p>TIP3P Water Model for Explicit Solvation</p>
<p>This module implements the TIP3P (Transferable Intermolecular Potential 3-Point) water model
for explicit solvation in molecular dynamics simulations.</p>
<p>The TIP3P model represents water molecules with three interaction sites:
- Oxygen atom with Lennard-Jones and electrostatic interactions
- Two hydrogen atoms with only electrostatic interactions
- Rigid geometry with fixed bond lengths and angles</p>
<p>Reference: W. L. Jorgensen et al., J. Chem. Phys. 79, 926 (1983)</p>
<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.water.</span></span><span class="sig-name descname"><span class="pre">TIP3PWaterModel</span></span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#TIP3PWaterModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>TIP3P water model implementation.</p>
<p>This class provides the TIP3P water model parameters and geometry
for explicit water solvation in molecular dynamics simulations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.OXYGEN_SIGMA">
<span class="sig-name descname"><span class="pre">OXYGEN_SIGMA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.31507</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.OXYGEN_SIGMA" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.OXYGEN_EPSILON">
<span class="sig-name descname"><span class="pre">OXYGEN_EPSILON</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.636</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.OXYGEN_EPSILON" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.OXYGEN_CHARGE">
<span class="sig-name descname"><span class="pre">OXYGEN_CHARGE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-0.834</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.OXYGEN_CHARGE" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.OXYGEN_MASS">
<span class="sig-name descname"><span class="pre">OXYGEN_MASS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">15.9994</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.OXYGEN_MASS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.HYDROGEN_SIGMA">
<span class="sig-name descname"><span class="pre">HYDROGEN_SIGMA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.HYDROGEN_SIGMA" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.HYDROGEN_EPSILON">
<span class="sig-name descname"><span class="pre">HYDROGEN_EPSILON</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.HYDROGEN_EPSILON" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.HYDROGEN_CHARGE">
<span class="sig-name descname"><span class="pre">HYDROGEN_CHARGE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.417</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.HYDROGEN_CHARGE" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.HYDROGEN_MASS">
<span class="sig-name descname"><span class="pre">HYDROGEN_MASS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.008</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.HYDROGEN_MASS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.OH_BOND_LENGTH">
<span class="sig-name descname"><span class="pre">OH_BOND_LENGTH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.09572</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.OH_BOND_LENGTH" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.HOH_ANGLE">
<span class="sig-name descname"><span class="pre">HOH_ANGLE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">104.52</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.HOH_ANGLE" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.WATER_DENSITY">
<span class="sig-name descname"><span class="pre">WATER_DENSITY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">997.0</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.WATER_DENSITY" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.WATER_MOLAR_MASS">
<span class="sig-name descname"><span class="pre">WATER_MOLAR_MASS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">18.01528</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.WATER_MOLAR_MASS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.AVOGADRO">
<span class="sig-name descname"><span class="pre">AVOGADRO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6.02214076e+23</span></em><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.AVOGADRO" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#TIP3PWaterModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the TIP3P water model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.create_single_water_molecule">
<span class="sig-name descname"><span class="pre">create_single_water_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center_position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#TIP3PWaterModel.create_single_water_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.create_single_water_molecule" title="Link to this definition">¶</a></dt>
<dd><p>Create a single TIP3P water molecule at a specified position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center_position</strong> (<em>np.ndarray</em>) – Position of the oxygen atom (center) in nm</p></li>
<li><p><strong>orientation</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Orientation vector for the molecule. If None, random orientation is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing positions, masses, charges, and atom types</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.water.TIP3PWaterModel.get_water_force_field_parameters">
<span class="sig-name descname"><span class="pre">get_water_force_field_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#TIP3PWaterModel.get_water_force_field_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.TIP3PWaterModel.get_water_force_field_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Get force field parameters for TIP3P water model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing force field parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.water.WaterSolvationBox">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.water.</span></span><span class="sig-name descname"><span class="pre">WaterSolvationBox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tip3p_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_distance_to_solute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_water_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#WaterSolvationBox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.WaterSolvationBox" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class for creating and managing water solvation around biomolecules.</p>
<p>This class provides functionality to:
- Place water molecules around proteins
- Maintain minimum distances
- Calculate densities
- Validate solvation quality</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.water.WaterSolvationBox.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tip3p_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_distance_to_solute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_water_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#WaterSolvationBox.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.WaterSolvationBox.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the water solvation box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tip3p_model</strong> (<a class="reference internal" href="#id0" title="proteinMD.environment.water.TIP3PWaterModel"><em>TIP3PWaterModel</em></a><em>, </em><em>optional</em>) – TIP3P model instance. If None, creates a new one.</p></li>
<li><p><strong>min_distance_to_solute</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum distance from water to solute atoms in nm</p></li>
<li><p><strong>min_water_distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum distance between water molecules in nm</p></li>
<li><p><strong>target_density</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Target density in kg/m³. If None, uses standard water density.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.water.WaterSolvationBox.solvate_protein">
<span class="sig-name descname"><span class="pre">solvate_protein</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protein_positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_attempts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#WaterSolvationBox.solvate_protein"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.WaterSolvationBox.solvate_protein" title="Link to this definition">¶</a></dt>
<dd><p>Solvate a protein with TIP3P water molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protein_positions</strong> (<em>np.ndarray</em>) – Positions of protein atoms with shape (n_atoms, 3) in nm</p></li>
<li><p><strong>box_dimensions</strong> (<em>np.ndarray</em>) – Box dimensions [x, y, z] in nm</p></li>
<li><p><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum padding around protein in nm</p></li>
<li><p><strong>max_attempts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – Maximum attempts to place water molecules</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing water molecule data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.water.WaterSolvationBox.calculate_water_density">
<span class="sig-name descname"><span class="pre">calculate_water_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_dimensions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#WaterSolvationBox.calculate_water_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.WaterSolvationBox.calculate_water_density" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the density of the water in the box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>box_dimensions</strong> (<em>np.ndarray</em>) – Box dimensions in nm</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Water density in kg/m³</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.water.WaterSolvationBox.validate_solvation">
<span class="sig-name descname"><span class="pre">validate_solvation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">protein_positions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#WaterSolvationBox.validate_solvation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.WaterSolvationBox.validate_solvation" title="Link to this definition">¶</a></dt>
<dd><p>Validate the quality of the solvation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box_dimensions</strong> (<em>np.ndarray</em>) – Box dimensions in nm</p></li>
<li><p><strong>protein_positions</strong> (<em>np.ndarray</em>) – Protein atom positions</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Validation metrics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.water.create_pure_water_box">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.water.</span></span><span class="sig-name descname"><span class="pre">create_pure_water_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_water_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.23</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#create_pure_water_box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.create_pure_water_box" title="Link to this definition">¶</a></dt>
<dd><p>Create a box of pure TIP3P water for density validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box_dimensions</strong> (<em>np.ndarray</em>) – Box dimensions [x, y, z] in nm</p></li>
<li><p><strong>target_density</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Target density in kg/m³</p></li>
<li><p><strong>min_water_distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Minimum distance between water molecules in nm</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Water system data including positions, masses, charges, etc.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.water.WaterSystem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.water.</span></span><span class="sig-name descname"><span class="pre">WaterSystem</span></span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#WaterSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.WaterSystem" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>High-level interface for water system creation and management.</p>
<p>This class provides a simplified interface for creating water boxes
and managing TIP3P water systems for molecular dynamics simulations.</p>
<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.water.WaterSystem.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#WaterSystem.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.WaterSystem.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize water system.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.water.WaterSystem.create_water_box">
<span class="sig-name descname"><span class="pre">create_water_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_water</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#WaterSystem.create_water_box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.WaterSystem.create_water_box" title="Link to this definition">¶</a></dt>
<dd><p>Create a box of water molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_water</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of water molecules</p></li>
<li><p><strong>box_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Size of the cubic box in nm</p></li>
<li><p><strong>density</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Target density in g/cm³</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>(positions, atom_types) where positions is (N, 3) array</dt><dd><p>and atom_types is list of atom type strings</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.water.WaterSystem.calculate_water_density">
<span class="sig-name descname"><span class="pre">calculate_water_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_dimensions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_water_molecules</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#WaterSystem.calculate_water_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.water.WaterSystem.calculate_water_density" title="Link to this definition">¶</a></dt>
<dd><p>Calculate water density for given box and number of molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box_dimensions</strong> – Box dimensions in nm</p></li>
<li><p><strong>n_water_molecules</strong> – Number of water molecules</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Density in kg/m³</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="tip3p-water-model">
<h3>TIP3P Water Model<a class="headerlink" href="#tip3p-water-model" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.water.</span></span><span class="sig-name descname"><span class="pre">TIP3PWaterModel</span></span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#TIP3PWaterModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>TIP3P water model implementation.</p>
<p>This class provides the TIP3P water model parameters and geometry
for explicit water solvation in molecular dynamics simulations.</p>
<p><strong>Examples</strong></p>
<p>Basic solvation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">water_model</span> <span class="o">=</span> <span class="n">TIP3PWaterModel</span><span class="p">()</span>

<span class="c1"># Solvate protein with default settings</span>
<span class="n">solvated_system</span> <span class="o">=</span> <span class="n">water_model</span><span class="o">.</span><span class="n">solvate_protein</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<p>Advanced solvation with ions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">water_model</span> <span class="o">=</span> <span class="n">TIP3PWaterModel</span><span class="p">(</span>
    <span class="n">density</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span>        <span class="c1"># Water density (kg/m³)</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mf">300.0</span>      <span class="c1"># Temperature for density calculation</span>
<span class="p">)</span>

<span class="c1"># Solvate with specific ion concentration</span>
<span class="n">solvated_system</span> <span class="o">=</span> <span class="n">water_model</span><span class="o">.</span><span class="n">solvate_protein</span><span class="p">(</span>
    <span class="n">protein</span><span class="o">=</span><span class="n">protein</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>           <span class="c1"># 1.5 nm padding around protein</span>
    <span class="n">box_type</span><span class="o">=</span><span class="s2">&quot;cubic&quot;</span><span class="p">,</span>      <span class="c1"># Cubic simulation box</span>
    <span class="n">ion_concentration</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="c1"># 150 mM salt concentration</span>
    <span class="n">positive_ion</span><span class="o">=</span><span class="s2">&quot;Na+&quot;</span><span class="p">,</span>    <span class="c1"># Sodium ions</span>
    <span class="n">negative_ion</span><span class="o">=</span><span class="s2">&quot;Cl-&quot;</span><span class="p">,</span>    <span class="c1"># Chloride ions</span>
    <span class="n">neutralize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>       <span class="c1"># Neutralize system charge</span>
    <span class="n">min_distance</span><span class="o">=</span><span class="mf">0.23</span>      <span class="c1"># Minimum distance between atoms (nm)</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added </span><span class="si">{</span><span class="n">water_model</span><span class="o">.</span><span class="n">n_water_molecules</span><span class="si">}</span><span class="s2"> water molecules&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added </span><span class="si">{</span><span class="n">water_model</span><span class="o">.</span><span class="n">n_positive_ions</span><span class="si">}</span><span class="s2"> Na+ ions&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Added </span><span class="si">{</span><span class="n">water_model</span><span class="o">.</span><span class="n">n_negative_ions</span><span class="si">}</span><span class="s2"> Cl- ions&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">OXYGEN_SIGMA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.31507</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">OXYGEN_EPSILON</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.636</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">OXYGEN_CHARGE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-0.834</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">OXYGEN_MASS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">15.9994</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">HYDROGEN_SIGMA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">HYDROGEN_EPSILON</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">HYDROGEN_CHARGE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.417</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">HYDROGEN_MASS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.008</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">OH_BOND_LENGTH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.09572</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">HOH_ANGLE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">104.52</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">WATER_DENSITY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">997.0</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">WATER_MOLAR_MASS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">18.01528</span></em></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">AVOGADRO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6.02214076e+23</span></em></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#TIP3PWaterModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Initialize the TIP3P water model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">create_single_water_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center_position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#TIP3PWaterModel.create_single_water_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Create a single TIP3P water molecule at a specified position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center_position</strong> (<em>np.ndarray</em>) – Position of the oxygen atom (center) in nm</p></li>
<li><p><strong>orientation</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Orientation vector for the molecule. If None, random orientation is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing positions, masses, charges, and atom types</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_water_force_field_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#TIP3PWaterModel.get_water_force_field_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get force field parameters for TIP3P water model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing force field parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="tip4p-water-model">
<h3>TIP4P Water Model<a class="headerlink" href="#tip4p-water-model" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.water.</span></span><span class="sig-name descname"><span class="pre">TIP3PWaterModel</span></span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#TIP3PWaterModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>TIP3P water model implementation.</p>
<p>This class provides the TIP3P water model parameters and geometry
for explicit water solvation in molecular dynamics simulations.</p>
<p><strong>Example Usage</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># TIP4P model with virtual sites</span>
<span class="n">tip4p_model</span> <span class="o">=</span> <span class="n">TIP4PWaterModel</span><span class="p">()</span>

<span class="c1"># Solvate with TIP4P water</span>
<span class="n">solvated_system</span> <span class="o">=</span> <span class="n">tip4p_model</span><span class="o">.</span><span class="n">solvate_protein</span><span class="p">(</span>
    <span class="n">protein</span><span class="o">=</span><span class="n">protein</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="mf">1.0</span>
<span class="p">)</span>

<span class="c1"># TIP4P includes virtual sites for better electrostatics</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Virtual sites: </span><span class="si">{</span><span class="n">tip4p_model</span><span class="o">.</span><span class="n">n_virtual_sites</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">OXYGEN_SIGMA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.31507</span></em><a class="headerlink" href="#id1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">OXYGEN_EPSILON</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.636</span></em><a class="headerlink" href="#id2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">OXYGEN_CHARGE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-0.834</span></em><a class="headerlink" href="#id3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">OXYGEN_MASS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">15.9994</span></em><a class="headerlink" href="#id4" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">HYDROGEN_SIGMA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#id5" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">HYDROGEN_EPSILON</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#id6" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">HYDROGEN_CHARGE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.417</span></em><a class="headerlink" href="#id7" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">HYDROGEN_MASS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.008</span></em><a class="headerlink" href="#id8" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">OH_BOND_LENGTH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.09572</span></em><a class="headerlink" href="#id9" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">HOH_ANGLE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">104.52</span></em><a class="headerlink" href="#id10" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">WATER_DENSITY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">997.0</span></em><a class="headerlink" href="#id11" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">WATER_MOLAR_MASS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">18.01528</span></em><a class="headerlink" href="#id12" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">AVOGADRO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6.02214076e+23</span></em><a class="headerlink" href="#id13" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#TIP3PWaterModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id14" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the TIP3P water model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">create_single_water_molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center_position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#TIP3PWaterModel.create_single_water_molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id15" title="Link to this definition">¶</a></dt>
<dd><p>Create a single TIP3P water molecule at a specified position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center_position</strong> (<em>np.ndarray</em>) – Position of the oxygen atom (center) in nm</p></li>
<li><p><strong>orientation</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Orientation vector for the molecule. If None, random orientation is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing positions, masses, charges, and atom types</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">get_water_force_field_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/water.html#TIP3PWaterModel.get_water_force_field_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id16" title="Link to this definition">¶</a></dt>
<dd><p>Get force field parameters for TIP3P water model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing force field parameters</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="module-proteinMD.environment.implicit_solvent">
<span id="implicit-solvent-models"></span><h2>Implicit Solvent Models<a class="headerlink" href="#module-proteinMD.environment.implicit_solvent" title="Link to this heading">¶</a></h2>
<p>Implicit Solvent Model Implementation</p>
<p>This module implements the Generalized Born/Surface Area (GB/SA) implicit solvent model
for molecular dynamics simulations. The model provides significant computational speedup
over explicit solvation while maintaining accuracy for protein folding studies.</p>
<p>Key Components:
1. Generalized Born (GB) model for electrostatic solvation
2. Surface Area (SA) term for hydrophobic interactions
3. Optimized algorithms for 10x+ speedup
4. Integration with existing MD framework</p>
<p>References:
- Still et al., J. Am. Chem. Soc. 112, 6127 (1990) - Original GB model
- Onufriev et al., Proteins 55, 383 (2004) - GB-OBC model
- Srinivasan et al., Theor. Chem. Acc. 101, 426 (1999) - PBSA approach</p>
<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.implicit_solvent.</span></span><span class="sig-name descname"><span class="pre">GBModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#GBModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>Different Generalized Born model variants.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBModel.GB_HCT">
<span class="sig-name descname"><span class="pre">GB_HCT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'GB-HCT'</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBModel.GB_HCT" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBModel.GB_OBC1">
<span class="sig-name descname"><span class="pre">GB_OBC1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'GB-OBC1'</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBModel.GB_OBC1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBModel.GB_OBC2">
<span class="sig-name descname"><span class="pre">GB_OBC2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'GB-OBC2'</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBModel.GB_OBC2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBModel.GB_NECK">
<span class="sig-name descname"><span class="pre">GB_NECK</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'GB-Neck'</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBModel.GB_NECK" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.SAModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.implicit_solvent.</span></span><span class="sig-name descname"><span class="pre">SAModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#SAModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.SAModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>Surface area calculation methods.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.SAModel.LCPO">
<span class="sig-name descname"><span class="pre">LCPO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'LCPO'</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.SAModel.LCPO" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.SAModel.ICOSA">
<span class="sig-name descname"><span class="pre">ICOSA</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ICOSA'</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.SAModel.ICOSA" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.SAModel.GAUSS">
<span class="sig-name descname"><span class="pre">GAUSS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'GAUSS'</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.SAModel.GAUSS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.AtomGBParameters">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.implicit_solvent.</span></span><span class="sig-name descname"><span class="pre">AtomGBParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_tension</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#AtomGBParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.AtomGBParameters" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>GB parameters for individual atoms.</p>
<dl class="field-list simple">
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.AtomGBParameters.radius">
<span class="sig-name descname"><span class="pre">radius</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.AtomGBParameters.radius" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.AtomGBParameters.screen">
<span class="sig-name descname"><span class="pre">screen</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.AtomGBParameters.screen" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.AtomGBParameters.charge">
<span class="sig-name descname"><span class="pre">charge</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.AtomGBParameters.charge" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.AtomGBParameters.surface_tension">
<span class="sig-name descname"><span class="pre">surface_tension</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.AtomGBParameters.surface_tension" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.AtomGBParameters.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">screen</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_tension</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#proteinMD.environment.implicit_solvent.AtomGBParameters.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBSAParameters">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.implicit_solvent.</span></span><span class="sig-name descname"><span class="pre">GBSAParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interior_dielectric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solvent_dielectric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">78.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ionic_strength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_tension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_off</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probe_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.009</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#GBSAParameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBSAParameters" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Global GBSA model parameters.</p>
<dl class="field-list simple">
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBSAParameters.interior_dielectric">
<span class="sig-name descname"><span class="pre">interior_dielectric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBSAParameters.interior_dielectric" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBSAParameters.solvent_dielectric">
<span class="sig-name descname"><span class="pre">solvent_dielectric</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">78.5</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBSAParameters.solvent_dielectric" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBSAParameters.ionic_strength">
<span class="sig-name descname"><span class="pre">ionic_strength</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBSAParameters.ionic_strength" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBSAParameters.surface_tension">
<span class="sig-name descname"><span class="pre">surface_tension</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0072</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBSAParameters.surface_tension" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBSAParameters.cut_off">
<span class="sig-name descname"><span class="pre">cut_off</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2.0</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBSAParameters.cut_off" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBSAParameters.probe_radius">
<span class="sig-name descname"><span class="pre">probe_radius</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.14</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBSAParameters.probe_radius" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBSAParameters.offset">
<span class="sig-name descname"><span class="pre">offset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.009</span></em><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBSAParameters.offset" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GBSAParameters.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interior_dielectric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solvent_dielectric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">78.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ionic_strength</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_tension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0072</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut_off</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">probe_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.009</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GBSAParameters.__init__" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GeneralizedBornModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.implicit_solvent.</span></span><span class="sig-name descname"><span class="pre">GeneralizedBornModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GBModel.GB_OBC2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#GeneralizedBornModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GeneralizedBornModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Generalized Born model for electrostatic solvation.</p>
<p>The GB model approximates the electrostatic solvation free energy
by treating the solute as a low-dielectric cavity in a high-dielectric
continuum solvent.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GeneralizedBornModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GBModel.GB_OBC2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#GeneralizedBornModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GeneralizedBornModel.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the Generalized Born model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_type</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.GBModel" title="proteinMD.environment.implicit_solvent.GBModel"><em>GBModel</em></a>) – Type of GB model to use</p></li>
<li><p><strong>parameters</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.GBSAParameters" title="proteinMD.environment.implicit_solvent.GBSAParameters"><em>GBSAParameters</em></a><em>, </em><em>optional</em>) – Model parameters. Uses defaults if None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GeneralizedBornModel.calculate_born_radii">
<span class="sig-name descname"><span class="pre">calculate_born_radii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_radii</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#GeneralizedBornModel.calculate_born_radii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GeneralizedBornModel.calculate_born_radii" title="Link to this definition">¶</a></dt>
<dd><p>Calculate effective Born radii for all atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Atomic positions with shape (n_atoms, 3) in nm</p></li>
<li><p><strong>atom_radii</strong> (<em>np.ndarray</em>) – Intrinsic atomic radii with shape (n_atoms,) in nm</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Effective Born radii with shape (n_atoms,) in nm</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.GeneralizedBornModel.calculate_gb_energy_and_forces">
<span class="sig-name descname"><span class="pre">calculate_gb_energy_and_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">born_radii</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#GeneralizedBornModel.calculate_gb_energy_and_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.GeneralizedBornModel.calculate_gb_energy_and_forces" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Generalized Born solvation energy and forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Atomic positions with shape (n_atoms, 3) in nm</p></li>
<li><p><strong>charges</strong> (<em>np.ndarray</em>) – Atomic charges with shape (n_atoms,) in e</p></li>
<li><p><strong>born_radii</strong> (<em>np.ndarray</em>) – Born radii with shape (n_atoms,) in nm</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(solvation_energy, forces) where energy is in kJ/mol
and forces have shape (n_atoms, 3) in kJ/mol/nm</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.SurfaceAreaModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.implicit_solvent.</span></span><span class="sig-name descname"><span class="pre">SurfaceAreaModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">SAModel.LCPO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#SurfaceAreaModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.SurfaceAreaModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Surface area calculation for hydrophobic interactions.</p>
<p>The SA term accounts for the hydrophobic effect by calculating
the solvent-accessible surface area and applying surface tension.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.SurfaceAreaModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">SAModel.LCPO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#SurfaceAreaModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.SurfaceAreaModel.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the Surface Area model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_type</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.SAModel" title="proteinMD.environment.implicit_solvent.SAModel"><em>SAModel</em></a>) – Type of SA calculation method</p></li>
<li><p><strong>parameters</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.GBSAParameters" title="proteinMD.environment.implicit_solvent.GBSAParameters"><em>GBSAParameters</em></a><em>, </em><em>optional</em>) – Model parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.SurfaceAreaModel.calculate_surface_area_and_forces">
<span class="sig-name descname"><span class="pre">calculate_surface_area_and_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radii</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_tensions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#SurfaceAreaModel.calculate_surface_area_and_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.SurfaceAreaModel.calculate_surface_area_and_forces" title="Link to this definition">¶</a></dt>
<dd><p>Calculate surface area energy and forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Atomic positions with shape (n_atoms, 3) in nm</p></li>
<li><p><strong>radii</strong> (<em>np.ndarray</em>) – Atomic radii with shape (n_atoms,) in nm</p></li>
<li><p><strong>surface_tensions</strong> (<em>np.ndarray</em>) – Surface tension coefficients with shape (n_atoms,) in kJ/mol/nm²</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(surface_energy, forces) where energy is in kJ/mol
and forces have shape (n_atoms, 3) in kJ/mol/nm</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.ImplicitSolventModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.implicit_solvent.</span></span><span class="sig-name descname"><span class="pre">ImplicitSolventModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gb_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GBModel.GB_OBC2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sa_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">SAModel.LCPO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.ImplicitSolventModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Complete Generalized Born/Surface Area (GB/SA) implicit solvent model.</p>
<p>This class combines the GB electrostatic model with the SA hydrophobic
model to provide a complete implicit solvation treatment.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.ImplicitSolventModel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gb_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GBModel.GB_OBC2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sa_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">SAModel.LCPO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.ImplicitSolventModel.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the implicit solvent model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gb_model</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.GBModel" title="proteinMD.environment.implicit_solvent.GBModel"><em>GBModel</em></a>) – Generalized Born model variant</p></li>
<li><p><strong>sa_model</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.SAModel" title="proteinMD.environment.implicit_solvent.SAModel"><em>SAModel</em></a>) – Surface area calculation method</p></li>
<li><p><strong>parameters</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.GBSAParameters" title="proteinMD.environment.implicit_solvent.GBSAParameters"><em>GBSAParameters</em></a><em>, </em><em>optional</em>) – Model parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.ImplicitSolventModel.set_atom_parameters">
<span class="sig-name descname"><span class="pre">set_atom_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventModel.set_atom_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.ImplicitSolventModel.set_atom_parameters" title="Link to this definition">¶</a></dt>
<dd><p>Set atom-specific parameters for the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Atom indices in the system</p></li>
<li><p><strong>atom_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Atom type names (e.g., ‘C’, ‘N’, ‘O’)</p></li>
<li><p><strong>charges</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Partial charges in elementary units</p></li>
<li><p><strong>custom_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Custom parameters for specific atom types</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.ImplicitSolventModel.calculate_solvation_energy_and_forces">
<span class="sig-name descname"><span class="pre">calculate_solvation_energy_and_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventModel.calculate_solvation_energy_and_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.ImplicitSolventModel.calculate_solvation_energy_and_forces" title="Link to this definition">¶</a></dt>
<dd><p>Calculate total implicit solvation energy and forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>positions</strong> (<em>np.ndarray</em>) – Atomic positions with shape (n_atoms, 3) in nm</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(total_energy, forces) where energy is in kJ/mol
and forces have shape (n_atoms, 3) in kJ/mol/nm</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.ImplicitSolventModel.get_performance_stats">
<span class="sig-name descname"><span class="pre">get_performance_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventModel.get_performance_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.ImplicitSolventModel.get_performance_stats" title="Link to this definition">¶</a></dt>
<dd><p>Get performance statistics.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.ImplicitSolventModel.validate_speedup">
<span class="sig-name descname"><span class="pre">validate_speedup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_repeats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventModel.validate_speedup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.ImplicitSolventModel.validate_speedup" title="Link to this definition">¶</a></dt>
<dd><p>Validate computational speedup compared to explicit solvent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Test positions</p></li>
<li><p><strong>n_repeats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of calculations to average over</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Performance metrics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.ImplicitSolventForceTerm">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.implicit_solvent.</span></span><span class="sig-name descname"><span class="pre">ImplicitSolventForceTerm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">implicit_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventForceTerm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.ImplicitSolventForceTerm" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ForceTerm</span></code></p>
<p>Force term for implicit solvent in the MD force field framework.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.ImplicitSolventForceTerm.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">implicit_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventForceTerm.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.ImplicitSolventForceTerm.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize implicit solvent force term.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>implicit_model</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.ImplicitSolventModel" title="proteinMD.environment.implicit_solvent.ImplicitSolventModel"><em>ImplicitSolventModel</em></a>) – Configured implicit solvent model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.ImplicitSolventForceTerm.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventForceTerm.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.ImplicitSolventForceTerm.calculate" title="Link to this definition">¶</a></dt>
<dd><p>Calculate implicit solvent forces and energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Particle positions with shape (n_particles, 3) in nm</p></li>
<li><p><strong>box_vectors</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Periodic box vectors (not used for implicit solvent)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(forces, potential_energy) where forces have shape (n_particles, 3)
in kJ/mol/nm and energy is in kJ/mol</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.create_default_implicit_solvent">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.implicit_solvent.</span></span><span class="sig-name descname"><span class="pre">create_default_implicit_solvent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gb_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GBModel.GB_OBC2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sa_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">SAModel.LCPO</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#create_default_implicit_solvent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.create_default_implicit_solvent" title="Link to this definition">¶</a></dt>
<dd><p>Create a default implicit solvent model for a protein system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Atom type names for all atoms</p></li>
<li><p><strong>charges</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Partial charges for all atoms</p></li>
<li><p><strong>gb_model</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.GBModel" title="proteinMD.environment.implicit_solvent.GBModel"><em>GBModel</em></a>) – GB model variant to use</p></li>
<li><p><strong>sa_model</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.SAModel" title="proteinMD.environment.implicit_solvent.SAModel"><em>SAModel</em></a>) – SA model variant to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Configured implicit solvent model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#proteinMD.environment.implicit_solvent.ImplicitSolventModel" title="proteinMD.environment.implicit_solvent.ImplicitSolventModel">ImplicitSolventModel</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.implicit_solvent.benchmark_implicit_vs_explicit">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.implicit_solvent.</span></span><span class="sig-name descname"><span class="pre">benchmark_implicit_vs_explicit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#benchmark_implicit_vs_explicit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.implicit_solvent.benchmark_implicit_vs_explicit" title="Link to this definition">¶</a></dt>
<dd><p>Benchmark implicit solvent performance against explicit solvent expectations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Benchmark results</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<section id="generalized-born-model">
<h3>Generalized Born Model<a class="headerlink" href="#generalized-born-model" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.implicit_solvent.</span></span><span class="sig-name descname"><span class="pre">ImplicitSolventModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gb_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GBModel.GB_OBC2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sa_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">SAModel.LCPO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Complete Generalized Born/Surface Area (GB/SA) implicit solvent model.</p>
<p>This class combines the GB electrostatic model with the SA hydrophobic
model to provide a complete implicit solvation treatment.</p>
<p><strong>Examples</strong></p>
<p>Basic implicit solvent:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.implicit_solvent</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImplicitSolventModel</span>

<span class="c1"># Setup implicit solvent</span>
<span class="n">implicit_solvent</span> <span class="o">=</span> <span class="n">ImplicitSolventModel</span><span class="p">(</span>
    <span class="n">solvent_dielectric</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span>    <span class="c1"># Water dielectric constant</span>
    <span class="n">solute_dielectric</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>      <span class="c1"># Protein dielectric constant</span>
    <span class="n">salt_concentration</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>    <span class="c1"># 150 mM ionic strength</span>
    <span class="n">temperature</span><span class="o">=</span><span class="mf">300.0</span>           <span class="c1"># Temperature in Kelvin</span>
<span class="p">)</span>

<span class="c1"># Apply to protein</span>
<span class="n">implicit_solvent</span><span class="o">.</span><span class="n">apply_to_protein</span><span class="p">(</span><span class="n">protein</span><span class="p">)</span>

<span class="c1"># Calculate solvation free energy</span>
<span class="n">delta_g_solv</span> <span class="o">=</span> <span class="n">implicit_solvent</span><span class="o">.</span><span class="n">calculate_solvation_energy</span><span class="p">(</span>
    <span class="n">protein</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solvation free energy: </span><span class="si">{</span><span class="n">delta_g_solv</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Advanced GB model configuration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configure GB model parameters</span>
<span class="n">implicit_solvent</span> <span class="o">=</span> <span class="n">ImplicitSolventModel</span><span class="p">(</span>
    <span class="n">gb_model</span><span class="o">=</span><span class="s2">&quot;HCT&quot;</span><span class="p">,</span>            <span class="c1"># HCT, OBC1, or OBC2</span>
    <span class="n">solvent_dielectric</span><span class="o">=</span><span class="mf">80.0</span><span class="p">,</span>
    <span class="n">solute_dielectric</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">salt_concentration</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
    <span class="n">surface_tension</span><span class="o">=</span><span class="mf">0.0072</span><span class="p">,</span>    <span class="c1"># kJ/mol/nm² (for SA term)</span>
    <span class="n">probe_radius</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span>         <span class="c1"># Solvent probe radius (nm)</span>
    <span class="n">use_cutoff</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">cutoff</span><span class="o">=</span><span class="mf">2.0</span>                 <span class="c1"># GB cutoff distance (nm)</span>
<span class="p">)</span>

<span class="c1"># Calculate Born radii</span>
<span class="n">born_radii</span> <span class="o">=</span> <span class="n">implicit_solvent</span><span class="o">.</span><span class="n">calculate_born_radii</span><span class="p">(</span><span class="n">protein</span><span class="o">.</span><span class="n">get_positions</span><span class="p">())</span>

<span class="c1"># Calculate GB energy components</span>
<span class="n">energy_components</span> <span class="o">=</span> <span class="n">implicit_solvent</span><span class="o">.</span><span class="n">calculate_energy_components</span><span class="p">(</span>
    <span class="n">protein</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GB energy: </span><span class="si">{</span><span class="n">energy_components</span><span class="p">[</span><span class="s1">&#39;gb&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SA energy: </span><span class="si">{</span><span class="n">energy_components</span><span class="p">[</span><span class="s1">&#39;sa&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> kJ/mol&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gb_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">GBModel.GB_OBC2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sa_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">SAModel.LCPO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventModel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Initialize the implicit solvent model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gb_model</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.GBModel" title="proteinMD.environment.implicit_solvent.GBModel"><em>GBModel</em></a>) – Generalized Born model variant</p></li>
<li><p><strong>sa_model</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.SAModel" title="proteinMD.environment.implicit_solvent.SAModel"><em>SAModel</em></a>) – Surface area calculation method</p></li>
<li><p><strong>parameters</strong> (<a class="reference internal" href="#proteinMD.environment.implicit_solvent.GBSAParameters" title="proteinMD.environment.implicit_solvent.GBSAParameters"><em>GBSAParameters</em></a><em>, </em><em>optional</em>) – Model parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">set_atom_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventModel.set_atom_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Set atom-specific parameters for the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Atom indices in the system</p></li>
<li><p><strong>atom_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Atom type names (e.g., ‘C’, ‘N’, ‘O’)</p></li>
<li><p><strong>charges</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em> of </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Partial charges in elementary units</p></li>
<li><p><strong>custom_params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Custom parameters for specific atom types</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">calculate_solvation_energy_and_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventModel.calculate_solvation_energy_and_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculate total implicit solvation energy and forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>positions</strong> (<em>np.ndarray</em>) – Atomic positions with shape (n_atoms, 3) in nm</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(total_energy, forces) where energy is in kJ/mol
and forces have shape (n_atoms, 3) in kJ/mol/nm</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_performance_stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventModel.get_performance_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get performance statistics.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">validate_speedup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_repeats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/implicit_solvent.html#ImplicitSolventModel.validate_speedup"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Validate computational speedup compared to explicit solvent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Test positions</p></li>
<li><p><strong>n_repeats</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of calculations to average over</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Performance metrics</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="module-proteinMD.environment.periodic_boundary">
<span id="periodic-boundary-conditions"></span><h2>Periodic Boundary Conditions<a class="headerlink" href="#module-proteinMD.environment.periodic_boundary" title="Link to this heading">¶</a></h2>
<p>Periodic Boundary Conditions (PBC) Module</p>
<p>This module implements comprehensive periodic boundary conditions for molecular dynamics simulations,
including support for cubic, orthogonal, and triclinic boxes, minimum image convention, and
pressure coupling functionality.</p>
<p>Task 5.2: Periodische Randbedingungen 📊
- Kubische und orthogonale Boxen unterstützt ✓
- Minimum Image Convention korrekt implementiert ✓
- Keine Artefakte an Box-Grenzen sichtbar ✓
- Pressure Coupling funktioniert mit PBC ✓</p>
<p>References:
- Frenkel, D. &amp; Smit, B. Understanding Molecular Simulation (2002)
- Tuckerman, M. Statistical Mechanics: Theory and Molecular Simulation (2010)</p>
<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.BoxType">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">BoxType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#BoxType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.BoxType" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>Enumeration of supported simulation box types.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.BoxType.CUBIC">
<span class="sig-name descname"><span class="pre">CUBIC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'cubic'</span></em><a class="headerlink" href="#proteinMD.environment.periodic_boundary.BoxType.CUBIC" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.BoxType.ORTHOGONAL">
<span class="sig-name descname"><span class="pre">ORTHOGONAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'orthogonal'</span></em><a class="headerlink" href="#proteinMD.environment.periodic_boundary.BoxType.ORTHOGONAL" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.BoxType.TRICLINIC">
<span class="sig-name descname"><span class="pre">TRICLINIC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'triclinic'</span></em><a class="headerlink" href="#proteinMD.environment.periodic_boundary.BoxType.TRICLINIC" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">PeriodicBox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_lengths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_angles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class representing a periodic simulation box.</p>
<p>This class handles all box types (cubic, orthogonal, triclinic) and provides
utilities for distance calculations, coordinate wrapping, and volume computations.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_lengths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_angles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBox.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize a periodic box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box_vectors</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – 3x3 matrix of box vectors in nm. If provided, takes precedence.</p></li>
<li><p><strong>box_lengths</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Box lengths [a, b, c] in nm</p></li>
<li><p><strong>box_angles</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Box angles [α, β, γ] in degrees. Default: [90, 90, 90]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox.box_lengths">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">box_lengths</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox.box_lengths" title="Link to this definition">¶</a></dt>
<dd><p>Get box lengths [a, b, c] in nm.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox.box_angles">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">box_angles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox.box_angles" title="Link to this definition">¶</a></dt>
<dd><p>Get box angles [α, β, γ] in degrees.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox.box_type">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">box_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#id17" title="proteinMD.environment.periodic_boundary.BoxType"><span class="pre">BoxType</span></a></em><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox.box_type" title="Link to this definition">¶</a></dt>
<dd><p>Determine the type of simulation box.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox.volume">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">volume</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></em><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox.volume" title="Link to this definition">¶</a></dt>
<dd><p>Get box volume in nm³.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox.reciprocal_vectors">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reciprocal_vectors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox.reciprocal_vectors" title="Link to this definition">¶</a></dt>
<dd><p>Get reciprocal lattice vectors (for efficient distance calculations).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox.apply_minimum_image_convention">
<span class="sig-name descname"><span class="pre">apply_minimum_image_convention</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBox.apply_minimum_image_convention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox.apply_minimum_image_convention" title="Link to this definition">¶</a></dt>
<dd><p>Apply minimum image convention to distance vectors.</p>
<p>This is the core PBC function that ensures the shortest distance
between two points is calculated across periodic boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dr</strong> (<em>np.ndarray</em>) – Distance vector(s) with shape (…, 3)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Corrected distance vector(s) using minimum image convention</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox.wrap_positions">
<span class="sig-name descname"><span class="pre">wrap_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBox.wrap_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox.wrap_positions" title="Link to this definition">¶</a></dt>
<dd><p>Wrap particle positions into the primary unit cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>positions</strong> (<em>np.ndarray</em>) – Particle positions with shape (n_particles, 3)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Wrapped positions</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox.calculate_distance">
<span class="sig-name descname"><span class="pre">calculate_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBox.calculate_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox.calculate_distance" title="Link to this definition">¶</a></dt>
<dd><p>Calculate minimum distance between two positions with PBC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos1</strong> (<em>np.ndarray</em>) – Position vectors</p></li>
<li><p><strong>pos2</strong> (<em>np.ndarray</em>) – Position vectors</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Minimum distance</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox.calculate_distance_matrix">
<span class="sig-name descname"><span class="pre">calculate_distance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBox.calculate_distance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox.calculate_distance_matrix" title="Link to this definition">¶</a></dt>
<dd><p>Calculate pairwise distance matrix with PBC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>positions</strong> (<em>np.ndarray</em>) – Particle positions with shape (n_particles, 3)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Distance matrix with shape (n_particles, n_particles)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox.get_neighbor_images">
<span class="sig-name descname"><span class="pre">get_neighbor_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBox.get_neighbor_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox.get_neighbor_images" title="Link to this definition">¶</a></dt>
<dd><p>Get neighbor list considering periodic images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Particle positions</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Interaction cutoff distance</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary containing neighbor information</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBox.scale_box">
<span class="sig-name descname"><span class="pre">scale_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBox.scale_box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBox.scale_box" title="Link to this definition">¶</a></dt>
<dd><p>Scale the simulation box (for pressure coupling).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scale_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> or </em><em>np.ndarray</em>) – Scaling factor(s) for box dimensions</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PressureCoupling">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">PressureCoupling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compressibility</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'berendsen'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PressureCoupling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PressureCoupling" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Pressure coupling algorithms for use with periodic boundary conditions.</p>
<p>Implements various barostats (pressure control algorithms) that can be used
with molecular dynamics simulations to maintain constant pressure.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PressureCoupling.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_pressure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coupling_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compressibility</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'berendsen'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PressureCoupling.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PressureCoupling.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize pressure coupling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_pressure</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Target pressure in bar</p></li>
<li><p><strong>coupling_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Pressure coupling time constant in ps</p></li>
<li><p><strong>compressibility</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Isothermal compressibility in bar^-1</p></li>
<li><p><strong>algorithm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Pressure coupling algorithm (“berendsen”, “parrinello_rahman”)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PressureCoupling.calculate_pressure">
<span class="sig-name descname"><span class="pre">calculate_pressure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kinetic_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">virial_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PressureCoupling.calculate_pressure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PressureCoupling.calculate_pressure" title="Link to this definition">¶</a></dt>
<dd><p>Calculate instantaneous pressure from virial theorem.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kinetic_energy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Total kinetic energy in kJ/mol</p></li>
<li><p><strong>virial_tensor</strong> (<em>np.ndarray</em>) – 3x3 virial tensor in kJ/mol</p></li>
<li><p><strong>volume</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Box volume in nm³</p></li>
<li><p><strong>n_particles</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of particles</p></li>
<li><p><strong>temperature</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Temperature in K</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pressure in bar</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PressureCoupling.berendsen_scaling">
<span class="sig-name descname"><span class="pre">berendsen_scaling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PressureCoupling.berendsen_scaling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PressureCoupling.berendsen_scaling" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Berendsen pressure coupling scaling factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_pressure</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Current system pressure in bar</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step in ps</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Box scaling factor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PressureCoupling.parrinello_rahman_scaling">
<span class="sig-name descname"><span class="pre">parrinello_rahman_scaling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_velocities</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PressureCoupling.parrinello_rahman_scaling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PressureCoupling.parrinello_rahman_scaling" title="Link to this definition">¶</a></dt>
<dd><p>Calculate Parrinello-Rahman pressure coupling scaling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_pressure</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Current pressure in bar</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step in ps</p></li>
<li><p><strong>box_velocities</strong> (<em>np.ndarray</em>) – Current box velocities</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(scaling_factor, new_box_velocities)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PressureCoupling.apply_pressure_coupling">
<span class="sig-name descname"><span class="pre">apply_pressure_coupling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_velocities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PressureCoupling.apply_pressure_coupling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PressureCoupling.apply_pressure_coupling" title="Link to this definition">¶</a></dt>
<dd><p>Apply pressure coupling to simulation box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box</strong> (<a class="reference internal" href="#proteinMD.environment.periodic_boundary.PeriodicBox" title="proteinMD.environment.periodic_boundary.PeriodicBox"><em>PeriodicBox</em></a>) – Simulation box to scale</p></li>
<li><p><strong>current_pressure</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Current pressure in bar</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step in ps</p></li>
<li><p><strong>box_velocities</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Box velocities for PR coupling</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated box velocities (if applicable)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">PeriodicBoundaryConditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure_coupling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBoundaryConditions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Main class for handling periodic boundary conditions in MD simulations.</p>
<p>This class integrates all PBC functionality and provides a high-level interface
for molecular dynamics simulations.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure_coupling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBoundaryConditions.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialize periodic boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box</strong> (<a class="reference internal" href="#proteinMD.environment.periodic_boundary.PeriodicBox" title="proteinMD.environment.periodic_boundary.PeriodicBox"><em>PeriodicBox</em></a>) – Simulation box</p></li>
<li><p><strong>pressure_coupling</strong> (<a class="reference internal" href="#proteinMD.environment.periodic_boundary.PressureCoupling" title="proteinMD.environment.periodic_boundary.PressureCoupling"><em>PressureCoupling</em></a><em>, </em><em>optional</em>) – Pressure coupling algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions.update_positions">
<span class="sig-name descname"><span class="pre">update_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBoundaryConditions.update_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions.update_positions" title="Link to this definition">¶</a></dt>
<dd><p>Update positions with PBC wrapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Current positions</p></li>
<li><p><strong>velocities</strong> (<em>np.ndarray</em>) – Current velocities</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(wrapped_positions, velocities)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions.calculate_forces_with_pbc">
<span class="sig-name descname"><span class="pre">calculate_forces_with_pbc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBoundaryConditions.calculate_forces_with_pbc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions.calculate_forces_with_pbc" title="Link to this definition">¶</a></dt>
<dd><p>Calculate forces using periodic boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Particle positions</p></li>
<li><p><strong>force_function</strong> (<em>callable</em>) – Function to calculate forces</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Interaction cutoff</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments for force function</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(forces, potential_energy)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions.apply_pressure_control">
<span class="sig-name descname"><span class="pre">apply_pressure_control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_velocities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBoundaryConditions.apply_pressure_control"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions.apply_pressure_control" title="Link to this definition">¶</a></dt>
<dd><p>Apply pressure coupling if enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_pressure</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Current pressure</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step</p></li>
<li><p><strong>box_velocities</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Box velocities</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated box velocities if applicable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions.get_statistics">
<span class="sig-name descname"><span class="pre">get_statistics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBoundaryConditions.get_statistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions.get_statistics" title="Link to this definition">¶</a></dt>
<dd><p>Get PBC usage statistics.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.create_cubic_box">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">create_cubic_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#create_cubic_box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.create_cubic_box" title="Link to this definition">¶</a></dt>
<dd><p>Create a cubic simulation box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Box side length in nm</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cubic simulation box</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#proteinMD.environment.periodic_boundary.PeriodicBox" title="proteinMD.environment.periodic_boundary.PeriodicBox">PeriodicBox</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.create_orthogonal_box">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">create_orthogonal_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#create_orthogonal_box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.create_orthogonal_box" title="Link to this definition">¶</a></dt>
<dd><p>Create an orthogonal simulation box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lengths</strong> (<em>np.ndarray</em>) – Box lengths [a, b, c] in nm</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Orthogonal simulation box</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#proteinMD.environment.periodic_boundary.PeriodicBox" title="proteinMD.environment.periodic_boundary.PeriodicBox">PeriodicBox</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.create_triclinic_box">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">create_triclinic_box</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lengths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#create_triclinic_box"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.create_triclinic_box" title="Link to this definition">¶</a></dt>
<dd><p>Create a triclinic simulation box.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lengths</strong> (<em>np.ndarray</em>) – Box lengths [a, b, c] in nm</p></li>
<li><p><strong>angles</strong> (<em>np.ndarray</em>) – Box angles [α, β, γ] in degrees</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Triclinic simulation box</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#proteinMD.environment.periodic_boundary.PeriodicBox" title="proteinMD.environment.periodic_boundary.PeriodicBox">PeriodicBox</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.minimum_image_distance">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">minimum_image_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_vectors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#minimum_image_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.minimum_image_distance" title="Link to this definition">¶</a></dt>
<dd><p>Calculate minimum image distance between two positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pos1</strong> (<em>np.ndarray</em>) – Position vectors</p></li>
<li><p><strong>pos2</strong> (<em>np.ndarray</em>) – Position vectors</p></li>
<li><p><strong>box_vectors</strong> (<em>np.ndarray</em>) – 3x3 box vector matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Minimum distance with PBC</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.validate_minimum_image_convention">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">validate_minimum_image_convention</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#validate_minimum_image_convention"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.validate_minimum_image_convention" title="Link to this definition">¶</a></dt>
<dd><p>Validate that minimum image convention works correctly.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if validation passes</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.validate_box_types">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">validate_box_types</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#validate_box_types"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.validate_box_types" title="Link to this definition">¶</a></dt>
<dd><p>Validate different box types work correctly.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if validation passes</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.periodic_boundary.validate_pressure_coupling">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">validate_pressure_coupling</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#validate_pressure_coupling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#proteinMD.environment.periodic_boundary.validate_pressure_coupling" title="Link to this definition">¶</a></dt>
<dd><p>Validate pressure coupling functionality.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if validation passes</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

<section id="pbc-implementation">
<h3>PBC Implementation<a class="headerlink" href="#pbc-implementation" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">PeriodicBoundaryConditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure_coupling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBoundaryConditions"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Main class for handling periodic boundary conditions in MD simulations.</p>
<p>This class integrates all PBC functionality and provides a high-level interface
for molecular dynamics simulations.</p>
<p><strong>Examples</strong></p>
<p>Cubic box setup:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.periodic_boundary</span><span class="w"> </span><span class="kn">import</span> <span class="n">PeriodicBoundaryConditions</span>

<span class="n">pbc</span> <span class="o">=</span> <span class="n">PeriodicBoundaryConditions</span><span class="p">()</span>

<span class="c1"># Setup cubic box</span>
<span class="n">box_size</span> <span class="o">=</span> <span class="n">pbc</span><span class="o">.</span><span class="n">setup_cubic_box</span><span class="p">(</span>
    <span class="n">system</span><span class="o">=</span><span class="n">solvated_system</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="mf">0.5</span>  <span class="c1"># Additional padding beyond solvation</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Box size: </span><span class="si">{</span><span class="n">box_size</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> nm&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Custom box dimensions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setup rectangular box</span>
<span class="n">pbc</span><span class="o">.</span><span class="n">setup_rectangular_box</span><span class="p">(</span>
    <span class="n">system</span><span class="o">=</span><span class="n">solvated_system</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">]</span>  <span class="c1"># nm</span>
<span class="p">)</span>

<span class="c1"># Setup from box vectors</span>
<span class="n">box_vectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">pbc</span><span class="o">.</span><span class="n">set_box_vectors</span><span class="p">(</span><span class="n">box_vectors</span><span class="p">)</span>

<span class="c1"># Apply minimum image convention</span>
<span class="n">distance</span> <span class="o">=</span> <span class="n">pbc</span><span class="o">.</span><span class="n">minimum_image_distance</span><span class="p">(</span><span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">)</span>

<span class="c1"># Wrap coordinates into box</span>
<span class="n">wrapped_coords</span> <span class="o">=</span> <span class="n">pbc</span><span class="o">.</span><span class="n">wrap_coordinates</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure_coupling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBoundaryConditions.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Initialize periodic boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box</strong> (<a class="reference internal" href="#proteinMD.environment.periodic_boundary.PeriodicBox" title="proteinMD.environment.periodic_boundary.PeriodicBox"><em>PeriodicBox</em></a>) – Simulation box</p></li>
<li><p><strong>pressure_coupling</strong> (<a class="reference internal" href="#proteinMD.environment.periodic_boundary.PressureCoupling" title="proteinMD.environment.periodic_boundary.PressureCoupling"><em>PressureCoupling</em></a><em>, </em><em>optional</em>) – Pressure coupling algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">update_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">velocities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBoundaryConditions.update_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Update positions with PBC wrapping.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Current positions</p></li>
<li><p><strong>velocities</strong> (<em>np.ndarray</em>) – Current velocities</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(wrapped_positions, velocities)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">calculate_forces_with_pbc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBoundaryConditions.calculate_forces_with_pbc"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Calculate forces using periodic boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – Particle positions</p></li>
<li><p><strong>force_function</strong> (<em>callable</em>) – Function to calculate forces</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Interaction cutoff</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments for force function</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(forces, potential_energy)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">apply_pressure_control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_pressure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_velocities</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBoundaryConditions.apply_pressure_control"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Apply pressure coupling if enabled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_pressure</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Current pressure</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Time step</p></li>
<li><p><strong>box_velocities</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Box velocities</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated box velocities if applicable</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_statistics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#PeriodicBoundaryConditions.get_statistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get PBC usage statistics.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="id17">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.periodic_boundary.</span></span><span class="sig-name descname"><span class="pre">BoxType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/proteinMD/environment/periodic_boundary.html#BoxType"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id17" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<p>Enumeration of supported simulation box types.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">CUBIC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'cubic'</span></em><a class="headerlink" href="#id18" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">ORTHOGONAL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'orthogonal'</span></em><a class="headerlink" href="#id19" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">TRICLINIC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'triclinic'</span></em><a class="headerlink" href="#id20" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>
<section id="module-proteinMD.environment.ions">
<span id="ion-models"></span><h2>Ion Models<a class="headerlink" href="#module-proteinMD.environment.ions" title="Link to this heading">¶</a></h2>
<section id="ion-management">
<h3>Ion Management<a class="headerlink" href="#ion-management" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.ions.IonModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.ions.</span></span><span class="sig-name descname"><span class="pre">IonModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#proteinMD.environment.ions.IonModel" title="Link to this definition">¶</a></dt>
<dd><p>Bases:</p>
<p><strong>Example Usage</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.ions</span><span class="w"> </span><span class="kn">import</span> <span class="n">IonModel</span>

<span class="n">ion_model</span> <span class="o">=</span> <span class="n">IonModel</span><span class="p">()</span>

<span class="c1"># Add ions to neutralize system</span>
<span class="n">neutralized_system</span> <span class="o">=</span> <span class="n">ion_model</span><span class="o">.</span><span class="n">neutralize_system</span><span class="p">(</span>
    <span class="n">system</span><span class="o">=</span><span class="n">solvated_system</span><span class="p">,</span>
    <span class="n">positive_ion</span><span class="o">=</span><span class="s2">&quot;Na+&quot;</span><span class="p">,</span>
    <span class="n">negative_ion</span><span class="o">=</span><span class="s2">&quot;Cl-&quot;</span>
<span class="p">)</span>

<span class="c1"># Add specific ion concentration</span>
<span class="n">ionized_system</span> <span class="o">=</span> <span class="n">ion_model</span><span class="o">.</span><span class="n">add_ions</span><span class="p">(</span>
    <span class="n">system</span><span class="o">=</span><span class="n">solvated_system</span><span class="p">,</span>
    <span class="n">ion_concentration</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>  <span class="c1"># 150 mM</span>
    <span class="n">positive_ion</span><span class="o">=</span><span class="s2">&quot;K+&quot;</span><span class="p">,</span>       <span class="c1"># Potassium</span>
    <span class="n">negative_ion</span><span class="o">=</span><span class="s2">&quot;Cl-&quot;</span><span class="p">,</span>      <span class="c1"># Chloride</span>
    <span class="n">replace_solvent</span><span class="o">=</span><span class="kc">True</span>     <span class="c1"># Replace water molecules with ions</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.ions.Ion">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.ions.</span></span><span class="sig-name descname"><span class="pre">Ion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#proteinMD.environment.ions.Ion" title="Link to this definition">¶</a></dt>
<dd><p>Bases:</p>
</dd></dl>

</section>
</section>
<section id="module-proteinMD.environment.membrane">
<span id="membrane-models"></span><h2>Membrane Models<a class="headerlink" href="#module-proteinMD.environment.membrane" title="Link to this heading">¶</a></h2>
<section id="lipid-bilayer-models">
<h3>Lipid Bilayer Models<a class="headerlink" href="#lipid-bilayer-models" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="proteinMD.environment.membrane.LipidBilayer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">proteinMD.environment.membrane.</span></span><span class="sig-name descname"><span class="pre">LipidBilayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#proteinMD.environment.membrane.LipidBilayer" title="Link to this definition">¶</a></dt>
<dd><p>Bases:</p>
<p><strong>Example Usage</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.membrane</span><span class="w"> </span><span class="kn">import</span> <span class="n">LipidBilayer</span>

<span class="c1"># Create POPC bilayer</span>
<span class="n">bilayer</span> <span class="o">=</span> <span class="n">LipidBilayer</span><span class="p">(</span>
    <span class="n">lipid_type</span><span class="o">=</span><span class="s2">&quot;POPC&quot;</span><span class="p">,</span>       <span class="c1"># Phospholipid type</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="c1"># Membrane dimensions (nm)</span>
    <span class="n">n_lipids</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>            <span class="c1"># Number of lipids per leaflet</span>
    <span class="n">hydration</span><span class="o">=</span><span class="mi">40</span>             <span class="c1"># Water molecules per lipid</span>
<span class="p">)</span>

<span class="c1"># Insert membrane protein</span>
<span class="n">membrane_system</span> <span class="o">=</span> <span class="n">bilayer</span><span class="o">.</span><span class="n">insert_protein</span><span class="p">(</span>
    <span class="n">protein</span><span class="o">=</span><span class="n">membrane_protein</span><span class="p">,</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;transmembrane&quot;</span><span class="p">,</span>
    <span class="n">z_position</span><span class="o">=</span><span class="mf">0.0</span>  <span class="c1"># Center in membrane</span>
<span class="p">)</span>

<span class="c1"># Equilibrate membrane</span>
<span class="n">bilayer</span><span class="o">.</span><span class="n">equilibrate</span><span class="p">(</span><span class="n">n_steps</span><span class="o">=</span><span class="mi">50000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="module-proteinMD.environment.utils">
<span id="environment-utilities"></span><h2>Environment Utilities<a class="headerlink" href="#module-proteinMD.environment.utils" title="Link to this heading">¶</a></h2>
<section id="utility-functions">
<h3>Utility Functions<a class="headerlink" href="#utility-functions" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.utils.calculate_box_volume">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.utils.</span></span><span class="sig-name descname"><span class="pre">calculate_box_volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#proteinMD.environment.utils.calculate_box_volume" title="Link to this definition">¶</a></dt>
<dd><p><strong>Example Usage</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">calculate_box_volume</span>

<span class="n">volume</span> <span class="o">=</span> <span class="n">calculate_box_volume</span><span class="p">(</span><span class="n">box_vectors</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Box volume: </span><span class="si">{</span><span class="n">volume</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> nm³&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.utils.minimum_image_distance">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.utils.</span></span><span class="sig-name descname"><span class="pre">minimum_image_distance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#proteinMD.environment.utils.minimum_image_distance" title="Link to this definition">¶</a></dt>
<dd><p><strong>Example Usage</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimum_image_distance</span>

<span class="c1"># Calculate minimum image distance</span>
<span class="n">distance</span> <span class="o">=</span> <span class="n">minimum_image_distance</span><span class="p">(</span>
    <span class="n">pos1</span><span class="o">=</span><span class="n">atom1</span><span class="o">.</span><span class="n">position</span><span class="p">,</span>
    <span class="n">pos2</span><span class="o">=</span><span class="n">atom2</span><span class="o">.</span><span class="n">position</span><span class="p">,</span>
    <span class="n">box_vectors</span><span class="o">=</span><span class="n">box_vectors</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="proteinMD.environment.utils.solvation_shell_analysis">
<span class="sig-prename descclassname"><span class="pre">proteinMD.environment.utils.</span></span><span class="sig-name descname"><span class="pre">solvation_shell_analysis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#proteinMD.environment.utils.solvation_shell_analysis" title="Link to this definition">¶</a></dt>
<dd><p><strong>Example Usage</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">solvation_shell_analysis</span>

<span class="c1"># Analyze hydration shell</span>
<span class="n">shell_waters</span> <span class="o">=</span> <span class="n">solvation_shell_analysis</span><span class="p">(</span>
    <span class="n">protein_positions</span><span class="o">=</span><span class="n">protein</span><span class="o">.</span><span class="n">get_positions</span><span class="p">(),</span>
    <span class="n">water_positions</span><span class="o">=</span><span class="n">water_coords</span><span class="p">,</span>
    <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.35</span>  <span class="c1"># First solvation shell cutoff (nm)</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Waters in first shell: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">shell_waters</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="common-usage-patterns">
<h2>Common Usage Patterns<a class="headerlink" href="#common-usage-patterns" title="Link to this heading">¶</a></h2>
<section id="complete-solvation-setup">
<h3>Complete Solvation Setup<a class="headerlink" href="#complete-solvation-setup" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.water</span><span class="w"> </span><span class="kn">import</span> <span class="n">TIP3PWaterModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.periodic_boundary</span><span class="w"> </span><span class="kn">import</span> <span class="n">PeriodicBoundaryConditions</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.ions</span><span class="w"> </span><span class="kn">import</span> <span class="n">IonModel</span>

<span class="c1"># Load protein</span>
<span class="n">protein</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;protein.pdb&quot;</span><span class="p">)</span>

<span class="c1"># Center protein at origin</span>
<span class="n">protein</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="o">-</span><span class="n">protein</span><span class="o">.</span><span class="n">center_of_mass</span><span class="p">())</span>

<span class="c1"># Solvate protein</span>
<span class="n">water_model</span> <span class="o">=</span> <span class="n">TIP3PWaterModel</span><span class="p">()</span>
<span class="n">solvated_system</span> <span class="o">=</span> <span class="n">water_model</span><span class="o">.</span><span class="n">solvate_protein</span><span class="p">(</span>
    <span class="n">protein</span><span class="o">=</span><span class="n">protein</span><span class="p">,</span>
    <span class="n">padding</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span>              <span class="c1"># 1.2 nm water padding</span>
    <span class="n">min_distance</span><span class="o">=</span><span class="mf">0.23</span>         <span class="c1"># Minimum atom-water distance</span>
<span class="p">)</span>

<span class="c1"># Add ions for physiological conditions</span>
<span class="n">ion_model</span> <span class="o">=</span> <span class="n">IonModel</span><span class="p">()</span>
<span class="n">ionized_system</span> <span class="o">=</span> <span class="n">ion_model</span><span class="o">.</span><span class="n">add_ions</span><span class="p">(</span>
    <span class="n">system</span><span class="o">=</span><span class="n">solvated_system</span><span class="p">,</span>
    <span class="n">ion_concentration</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>   <span class="c1"># 150 mM NaCl</span>
    <span class="n">positive_ion</span><span class="o">=</span><span class="s2">&quot;Na+&quot;</span><span class="p">,</span>
    <span class="n">negative_ion</span><span class="o">=</span><span class="s2">&quot;Cl-&quot;</span><span class="p">,</span>
    <span class="n">neutralize</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># Setup periodic boundaries</span>
<span class="n">pbc</span> <span class="o">=</span> <span class="n">PeriodicBoundaryConditions</span><span class="p">()</span>
<span class="n">box_size</span> <span class="o">=</span> <span class="n">pbc</span><span class="o">.</span><span class="n">setup_cubic_box</span><span class="p">(</span><span class="n">ionized_system</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final system: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ionized_system</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span><span class="si">}</span><span class="s2"> atoms&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Box size: </span><span class="si">{</span><span class="n">box_size</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> nm&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;System density: </span><span class="si">{</span><span class="n">ionized_system</span><span class="o">.</span><span class="n">density</span><span class="p">()</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> kg/m³&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="implicit-vs-explicit-solvent-comparison">
<h3>Implicit vs Explicit Solvent Comparison<a class="headerlink" href="#implicit-vs-explicit-solvent-comparison" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.implicit_solvent</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImplicitSolventModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.water</span><span class="w"> </span><span class="kn">import</span> <span class="n">TIP3PWaterModel</span>

<span class="c1"># Setup explicit solvation</span>
<span class="n">water_model</span> <span class="o">=</span> <span class="n">TIP3PWaterModel</span><span class="p">()</span>
<span class="n">explicit_system</span> <span class="o">=</span> <span class="n">water_model</span><span class="o">.</span><span class="n">solvate_protein</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>

<span class="c1"># Setup implicit solvation</span>
<span class="n">implicit_solvent</span> <span class="o">=</span> <span class="n">ImplicitSolventModel</span><span class="p">()</span>
<span class="n">implicit_system</span> <span class="o">=</span> <span class="n">protein</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">implicit_solvent</span><span class="o">.</span><span class="n">apply_to_protein</span><span class="p">(</span><span class="n">implicit_system</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;System comparison:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Explicit solvent: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">explicit_system</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span><span class="si">}</span><span class="s2"> atoms&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Implicit solvent: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">implicit_system</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span><span class="si">}</span><span class="s2"> atoms&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Speedup factor: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">explicit_system</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">implicit_system</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">x&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="membrane-protein-setup">
<h3>Membrane Protein Setup<a class="headerlink" href="#membrane-protein-setup" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.membrane</span><span class="w"> </span><span class="kn">import</span> <span class="n">LipidBilayer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.water</span><span class="w"> </span><span class="kn">import</span> <span class="n">TIP3PWaterModel</span>

<span class="c1"># Create lipid bilayer</span>
<span class="n">bilayer</span> <span class="o">=</span> <span class="n">LipidBilayer</span><span class="p">(</span>
    <span class="n">lipid_type</span><span class="o">=</span><span class="s2">&quot;POPC&quot;</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="p">[</span><span class="mf">12.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">],</span>  <span class="c1"># Large membrane for protein</span>
    <span class="n">thickness</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span>            <span class="c1"># Membrane thickness</span>
    <span class="n">area_per_lipid</span><span class="o">=</span><span class="mf">0.68</span>       <span class="c1"># nm² per lipid</span>
<span class="p">)</span>

<span class="c1"># Insert transmembrane protein</span>
<span class="n">membrane_system</span> <span class="o">=</span> <span class="n">bilayer</span><span class="o">.</span><span class="n">insert_protein</span><span class="p">(</span>
    <span class="n">protein</span><span class="o">=</span><span class="n">transmembrane_protein</span><span class="p">,</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;transmembrane&quot;</span><span class="p">,</span>
    <span class="n">insertion_method</span><span class="o">=</span><span class="s2">&quot;CHARMM-GUI&quot;</span>
<span class="p">)</span>

<span class="c1"># Add water layers above and below membrane</span>
<span class="n">water_model</span> <span class="o">=</span> <span class="n">TIP3PWaterModel</span><span class="p">()</span>
<span class="n">hydrated_membrane</span> <span class="o">=</span> <span class="n">water_model</span><span class="o">.</span><span class="n">hydrate_membrane</span><span class="p">(</span>
    <span class="n">membrane_system</span><span class="o">=</span><span class="n">membrane_system</span><span class="p">,</span>
    <span class="n">water_thickness</span><span class="o">=</span><span class="mf">3.0</span>  <span class="c1"># 3 nm water layer on each side</span>
<span class="p">)</span>

<span class="c1"># Setup periodic boundaries for membrane simulation</span>
<span class="n">pbc</span> <span class="o">=</span> <span class="n">PeriodicBoundaryConditions</span><span class="p">()</span>
<span class="n">pbc</span><span class="o">.</span><span class="n">setup_membrane_box</span><span class="p">(</span><span class="n">hydrated_membrane</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="custom-environment-setup">
<h3>Custom Environment Setup<a class="headerlink" href="#custom-environment-setup" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">proteinMD.environment.custom</span><span class="w"> </span><span class="kn">import</span> <span class="n">CustomEnvironment</span>

<span class="c1"># Create custom environment</span>
<span class="n">custom_env</span> <span class="o">=</span> <span class="n">CustomEnvironment</span><span class="p">()</span>

<span class="c1"># Add custom solvent model</span>
<span class="n">custom_env</span><span class="o">.</span><span class="n">add_solvent</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;methanol&quot;</span><span class="p">,</span>
    <span class="n">dielectric</span><span class="o">=</span><span class="mf">32.7</span><span class="p">,</span>
    <span class="n">density</span><span class="o">=</span><span class="mf">791.3</span><span class="p">,</span>  <span class="c1"># kg/m³</span>
    <span class="n">molecule_structure</span><span class="o">=</span><span class="s2">&quot;methanol.mol2&quot;</span>
<span class="p">)</span>

<span class="c1"># Add custom boundary conditions</span>
<span class="n">custom_env</span><span class="o">.</span><span class="n">set_boundary_conditions</span><span class="p">(</span>
    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;spherical&quot;</span><span class="p">,</span>
    <span class="n">radius</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span>     <span class="c1"># 5 nm sphere</span>
    <span class="n">center</span><span class="o">=</span><span class="s2">&quot;protein_com&quot;</span>
<span class="p">)</span>

<span class="c1"># Apply environment to system</span>
<span class="n">custom_system</span> <span class="o">=</span> <span class="n">custom_env</span><span class="o">.</span><span class="n">apply_to_system</span><span class="p">(</span><span class="n">protein</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="performance-considerations">
<h3>Performance Considerations<a class="headerlink" href="#performance-considerations" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For large systems, optimize environment setup</span>
<span class="n">water_model</span> <span class="o">=</span> <span class="n">TIP3PWaterModel</span><span class="p">(</span>
    <span class="n">density_optimization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>     <span class="c1"># Optimize water density</span>
    <span class="n">parallel_solvation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>       <span class="c1"># Use parallel solvation</span>
    <span class="n">n_threads</span><span class="o">=</span><span class="mi">4</span>                    <span class="c1"># Number of threads</span>
<span class="p">)</span>

<span class="c1"># Use reduced precision for speed</span>
<span class="n">implicit_solvent</span> <span class="o">=</span> <span class="n">ImplicitSolventModel</span><span class="p">(</span>
    <span class="n">precision</span><span class="o">=</span><span class="s2">&quot;single&quot;</span><span class="p">,</span>            <span class="c1"># Single vs double precision</span>
    <span class="n">use_lookup_tables</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>        <span class="c1"># Faster Born radii calculation</span>
    <span class="n">cutoff</span><span class="o">=</span><span class="mf">2.0</span>                     <span class="c1"># Smaller cutoff for speed</span>
<span class="p">)</span>

<span class="c1"># Efficient PBC implementation</span>
<span class="n">pbc</span> <span class="o">=</span> <span class="n">PeriodicBoundaryConditions</span><span class="p">(</span>
    <span class="n">use_cell_lists</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>           <span class="c1"># Cell list optimization</span>
    <span class="n">cell_list_cutoff</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span>          <span class="c1"># Cell list cutoff</span>
    <span class="n">update_frequency</span><span class="o">=</span><span class="mi">20</span>            <span class="c1"># Update every 20 steps</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="core.html"><span class="doc">Core Simulation Engine</span></a> - Core simulation engine that uses environment models</p></li>
<li><p><a class="reference internal" href="forcefield.html"><span class="doc">Force Fields</span></a> - Force field parameters for environment interactions</p></li>
<li><p><a class="reference internal" href="analysis.html"><span class="doc">Analysis Tools</span></a> - Analysis tools for solvation and environment properties</p></li>
<li><p><a class="reference internal" href="../user_guide/tutorials.html"><span class="doc">Tutorials</span></a> - Environment setup tutorials</p></li>
<li><p><a class="reference internal" href="../advanced/performance.html"><span class="doc">Performance Optimization</span></a> - Performance optimization for large systems</p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo" />
    
    <h1 class="logo logo-name">ProteinMD</h1>
    
  </a>
</p>



<p class="blurb">Molecular Dynamics Simulation Library</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=your-username&repo=proteinmd&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/user_manual.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/cli_reference.html">CLI Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core Simulation Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure.html">Structure Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="forcefield.html">Force Fields</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Environment Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quick-example">Quick Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-proteinMD.environment.water">Explicit Water Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.water.TIP3PWaterModel"><code class="docutils literal notranslate"><span class="pre">TIP3PWaterModel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.water.WaterSolvationBox"><code class="docutils literal notranslate"><span class="pre">WaterSolvationBox</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.water.create_pure_water_box"><code class="docutils literal notranslate"><span class="pre">create_pure_water_box()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.water.WaterSystem"><code class="docutils literal notranslate"><span class="pre">WaterSystem</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip3p-water-model">TIP3P Water Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tip4p-water-model">TIP4P Water Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-proteinMD.environment.implicit_solvent">Implicit Solvent Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.implicit_solvent.GBModel"><code class="docutils literal notranslate"><span class="pre">GBModel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.implicit_solvent.SAModel"><code class="docutils literal notranslate"><span class="pre">SAModel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.implicit_solvent.AtomGBParameters"><code class="docutils literal notranslate"><span class="pre">AtomGBParameters</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.implicit_solvent.GBSAParameters"><code class="docutils literal notranslate"><span class="pre">GBSAParameters</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.implicit_solvent.GeneralizedBornModel"><code class="docutils literal notranslate"><span class="pre">GeneralizedBornModel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.implicit_solvent.SurfaceAreaModel"><code class="docutils literal notranslate"><span class="pre">SurfaceAreaModel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.implicit_solvent.ImplicitSolventModel"><code class="docutils literal notranslate"><span class="pre">ImplicitSolventModel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.implicit_solvent.ImplicitSolventForceTerm"><code class="docutils literal notranslate"><span class="pre">ImplicitSolventForceTerm</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.implicit_solvent.create_default_implicit_solvent"><code class="docutils literal notranslate"><span class="pre">create_default_implicit_solvent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.implicit_solvent.benchmark_implicit_vs_explicit"><code class="docutils literal notranslate"><span class="pre">benchmark_implicit_vs_explicit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#generalized-born-model">Generalized Born Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-proteinMD.environment.periodic_boundary">Periodic Boundary Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.periodic_boundary.BoxType"><code class="docutils literal notranslate"><span class="pre">BoxType</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.periodic_boundary.PeriodicBox"><code class="docutils literal notranslate"><span class="pre">PeriodicBox</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.periodic_boundary.PressureCoupling"><code class="docutils literal notranslate"><span class="pre">PressureCoupling</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.periodic_boundary.PeriodicBoundaryConditions"><code class="docutils literal notranslate"><span class="pre">PeriodicBoundaryConditions</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.periodic_boundary.create_cubic_box"><code class="docutils literal notranslate"><span class="pre">create_cubic_box()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.periodic_boundary.create_orthogonal_box"><code class="docutils literal notranslate"><span class="pre">create_orthogonal_box()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.periodic_boundary.create_triclinic_box"><code class="docutils literal notranslate"><span class="pre">create_triclinic_box()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.periodic_boundary.minimum_image_distance"><code class="docutils literal notranslate"><span class="pre">minimum_image_distance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.periodic_boundary.validate_minimum_image_convention"><code class="docutils literal notranslate"><span class="pre">validate_minimum_image_convention()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.periodic_boundary.validate_box_types"><code class="docutils literal notranslate"><span class="pre">validate_box_types()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#proteinMD.environment.periodic_boundary.validate_pressure_coupling"><code class="docutils literal notranslate"><span class="pre">validate_pressure_coupling()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pbc-implementation">PBC Implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-proteinMD.environment.ions">Ion Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ion-management">Ion Management</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-proteinMD.environment.membrane">Membrane Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lipid-bilayer-models">Lipid Bilayer Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-proteinMD.environment.utils">Environment Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#utility-functions">Utility Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#common-usage-patterns">Common Usage Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#complete-solvation-setup">Complete Solvation Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implicit-vs-explicit-solvent-comparison">Implicit vs Explicit Solvent Comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="#membrane-protein-setup">Membrane Protein Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-environment-setup">Custom Environment Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#performance-considerations">Performance Considerations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="analysis.html">Analysis Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">Sampling Methods API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization Tools API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced/scientific_background.html">Scientific Background and Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/performance.html">Performance Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/validation.html">Validation and Quality Assurance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/extending.html">Extending ProteinMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/troubleshooting.html">Troubleshooting Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer/developer_guide.html">ProteinMD Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/architecture.html">Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/contributing.html">Contributing to ProteinMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/coding_standards.html">Coding Standards and Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/api_design.html">API Design Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/testing.html">Testing Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/documentation.html">Documentation Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/git_workflow.html">Git Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/pull_request_guide.html">Pull Request Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/review_process.html">Review Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/release_process.html">Release Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/performance_guide.html">Performance Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/changelog.html#development-milestones">Development Milestones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/changelog.html#release-notes-details">Release Notes Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/changelog.html#upcoming-releases">Upcoming Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/changelog.html#release-process">Release Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html">Citation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#primary-citation">Primary Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#component-specific-citations">Component-Specific Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#backend-dependencies">Backend Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#version-specific-citations">Version-Specific Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#contributing-authors">Contributing Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#citation-tools">Citation Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#contact-for-citations">Contact for Citations</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://github.com/your-username/proteinmd">GitHub</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">API Reference</a><ul>
      <li>Previous: <a href="forcefield.html" title="previous chapter">Force Fields</a></li>
      <li>Next: <a href="analysis.html" title="next chapter">Analysis Tools</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, ProteinMD Development Team.
      
      |
      <a href="../_sources/api/environment.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/your-username/proteinmd" class="github">
        <img src="../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>