<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Testing Framework &#8212; ProteinMD 1.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Documentation Guidelines" href="documentation.html" />
    <link rel="prev" title="Contributing to ProteinMD" href="contributing.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="testing-framework">
<h1>Testing Framework<a class="headerlink" href="#testing-framework" title="Link to this heading">¶</a></h1>
<p>This document describes the testing framework and best practices for ProteinMD.</p>
<nav class="contents local" id="testing-topics">
<p class="topic-title">Testing Topics</p>
<ul class="simple">
<li><p><a class="reference internal" href="#test-organization" id="id1">Test Organization</a></p>
<ul>
<li><p><a class="reference internal" href="#test-structure" id="id2">Test Structure</a></p></li>
<li><p><a class="reference internal" href="#test-categories" id="id3">Test Categories</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#test-utilities" id="id4">Test Utilities</a></p>
<ul>
<li><p><a class="reference internal" href="#test-framework-classes" id="id5">Test Framework Classes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#test-fixtures" id="id6">Test Fixtures</a></p>
<ul>
<li><p><a class="reference internal" href="#pytest-fixtures" id="id7">Pytest Fixtures</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#test-configuration" id="id8">Test Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#pytest-configuration" id="id9">Pytest Configuration</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#continuous-integration" id="id10">Continuous Integration</a></p>
<ul>
<li><p><a class="reference internal" href="#github-actions-workflow" id="id11">GitHub Actions Workflow</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#test-data-management" id="id12">Test Data Management</a></p>
<ul>
<li><p><a class="reference internal" href="#test-data-organization" id="id13">Test Data Organization</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#test-reporting" id="id14">Test Reporting</a></p>
<ul>
<li><p><a class="reference internal" href="#coverage-reports" id="id15">Coverage Reports</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#best-practices" id="id16">Best Practices</a></p>
<ul>
<li><p><a class="reference internal" href="#test-writing-guidelines" id="id17">Test Writing Guidelines</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#see-also" id="id18">See Also</a></p></li>
</ul>
</nav>
<section id="test-organization">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Test Organization</a><a class="headerlink" href="#test-organization" title="Link to this heading">¶</a></h2>
<section id="test-structure">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">Test Structure</a><a class="headerlink" href="#test-structure" title="Link to this heading">¶</a></h3>
<p><strong>Directory Layout</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>tests/
├── conftest.py              # pytest configuration and fixtures
├── unit/                    # Unit tests
│   ├── __init__.py
│   ├── test_core/
│   │   ├── test_integrators.py
│   │   ├── test_thermostats.py
│   │   └── test_simulation.py
│   ├── test_structure/
│   │   ├── test_protein.py
│   │   ├── test_validation.py
│   │   └── test_io.py
│   ├── test_forcefield/
│   │   ├── test_amber.py
│   │   ├── test_charmm.py
│   │   └── test_parameters.py
│   ├── test_analysis/
│   │   ├── test_rmsd.py
│   │   ├── test_ramachandran.py
│   │   └── test_clustering.py
│   └── test_utils/
│       ├── test_math.py
│       └── test_io.py
├── integration/             # Integration tests
│   ├── test_workflows/
│   │   ├── test_basic_md.py
│   │   ├── test_free_energy.py
│   │   └── test_analysis_pipeline.py
│   └── test_backends/
│       ├── test_openmm.py
│       └── test_gromacs.py
├── regression/              # Regression tests
│   ├── test_numerical/
│   │   ├── test_energy_conservation.py
│   │   └── test_trajectory_comparison.py
│   └── reference_data/
│       ├── energy_values.json
│       └── trajectory_checksums.json
├── performance/             # Performance benchmarks
│   ├── test_benchmarks.py
│   └── profile_analysis.py
└── data/                    # Test data
    ├── structures/
    │   ├── small_protein.pdb
    │   ├── water_box.pdb
    │   └── ligand_complex.pdb
    ├── trajectories/
    │   └── test_trajectory.dcd
    └── parameters/
        ├── amber_params.dat
        └── custom_ff.xml
</pre></div>
</div>
</section>
<section id="test-categories">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Test Categories</a><a class="headerlink" href="#test-categories" title="Link to this heading">¶</a></h3>
<p><strong>1. Unit Tests</strong></p>
<p>Test individual components in isolation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.core.integrators</span><span class="w"> </span><span class="kn">import</span> <span class="n">VelocityVerletIntegrator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.testing</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_test_system</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TestVelocityVerletIntegrator</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test VelocityVerlet integrator implementation.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_integration_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test single integration step.&quot;&quot;&quot;</span>
        <span class="n">integrator</span> <span class="o">=</span> <span class="n">VelocityVerletIntegrator</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
        <span class="n">system</span> <span class="o">=</span> <span class="n">create_test_system</span><span class="p">(</span><span class="s2">&quot;harmonic_oscillator&quot;</span><span class="p">)</span>

        <span class="c1"># Get initial state</span>
        <span class="n">initial_pos</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">initial_vel</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_velocities</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Perform integration step</span>
        <span class="n">forces</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">calculate_forces</span><span class="p">()</span>
        <span class="n">integrator</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">forces</span><span class="p">)</span>

        <span class="c1"># Check positions and velocities changed</span>
        <span class="n">final_pos</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_positions</span><span class="p">()</span>
        <span class="n">final_vel</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_velocities</span><span class="p">()</span>

        <span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">initial_pos</span><span class="p">,</span> <span class="n">final_pos</span><span class="p">)</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">initial_vel</span><span class="p">,</span> <span class="n">final_vel</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_energy_conservation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test energy conservation for harmonic oscillator.&quot;&quot;&quot;</span>
        <span class="n">integrator</span> <span class="o">=</span> <span class="n">VelocityVerletIntegrator</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
        <span class="n">system</span> <span class="o">=</span> <span class="n">create_test_system</span><span class="p">(</span><span class="s2">&quot;harmonic_oscillator&quot;</span><span class="p">)</span>

        <span class="n">initial_energy</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_total_energy</span><span class="p">()</span>

        <span class="c1"># Run 1000 steps</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
            <span class="n">forces</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">calculate_forces</span><span class="p">()</span>
            <span class="n">integrator</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">forces</span><span class="p">)</span>

        <span class="n">final_energy</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">get_total_energy</span><span class="p">()</span>
        <span class="n">energy_drift</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">final_energy</span> <span class="o">-</span> <span class="n">initial_energy</span><span class="p">)</span>

        <span class="c1"># Energy should be conserved within tolerance</span>
        <span class="k">assert</span> <span class="n">energy_drift</span> <span class="o">&lt;</span> <span class="mf">0.01</span>  <span class="c1"># 0.01 kJ/mol tolerance</span>
</pre></div>
</div>
<p><strong>2. Integration Tests</strong></p>
<p>Test component interactions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.workflows</span><span class="w"> </span><span class="kn">import</span> <span class="n">BasicMDWorkflow</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.testing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">temporary_directory</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TestBasicMDWorkflow</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test complete MD workflow.&quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">slow</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_protein_in_water_simulation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test complete protein simulation workflow.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">temporary_directory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdir</span><span class="p">:</span>
            <span class="c1"># Set up workflow</span>
            <span class="n">workflow</span> <span class="o">=</span> <span class="n">BasicMDWorkflow</span><span class="p">(</span>
                <span class="n">input_pdb</span><span class="o">=</span><span class="s2">&quot;tests/data/structures/small_protein.pdb&quot;</span><span class="p">,</span>
                <span class="n">output_dir</span><span class="o">=</span><span class="n">tmpdir</span><span class="p">,</span>
                <span class="n">simulation_time</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>  <span class="c1"># 10 ps</span>
                <span class="n">temperature</span><span class="o">=</span><span class="mf">300.0</span><span class="p">,</span>
                <span class="n">pressure</span><span class="o">=</span><span class="mf">1.0</span>
            <span class="p">)</span>

            <span class="c1"># Run workflow</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">workflow</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

            <span class="c1"># Check outputs</span>
            <span class="k">assert</span> <span class="n">results</span><span class="o">.</span><span class="n">final_energy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">assert</span> <span class="n">results</span><span class="o">.</span><span class="n">trajectory_file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
            <span class="k">assert</span> <span class="n">results</span><span class="o">.</span><span class="n">log_file</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>

            <span class="c1"># Check trajectory length</span>
            <span class="n">trajectory</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">load_trajectory</span><span class="p">()</span>
            <span class="n">expected_frames</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.01</span> <span class="o">/</span> <span class="mf">0.002</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>  <span class="c1"># 10 ps / 2 fs / 100 (output freq)</span>
            <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trajectory</span><span class="p">)</span> <span class="o">-</span> <span class="n">expected_frames</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>
</pre></div>
</div>
<p><strong>3. Regression Tests</strong></p>
<p>Ensure numerical stability:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.testing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">load_reference_data</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TestNumericalRegression</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test numerical regression.&quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">regression</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_energy_values_regression</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that energy calculations remain consistent.&quot;&quot;&quot;</span>
        <span class="c1"># Load reference system</span>
        <span class="n">system</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_reference_system</span><span class="p">(</span><span class="s2">&quot;1ubq_solvated&quot;</span><span class="p">)</span>

        <span class="c1"># Calculate energies</span>
        <span class="n">potential_energy</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">calculate_potential_energy</span><span class="p">()</span>
        <span class="n">kinetic_energy</span> <span class="o">=</span> <span class="n">system</span><span class="o">.</span><span class="n">calculate_kinetic_energy</span><span class="p">()</span>

        <span class="c1"># Load reference values</span>
        <span class="n">reference</span> <span class="o">=</span> <span class="n">load_reference_data</span><span class="p">(</span><span class="s2">&quot;energy_values.json&quot;</span><span class="p">)</span>

        <span class="c1"># Compare within tolerance</span>
        <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span>
            <span class="n">potential_energy</span><span class="p">,</span>
            <span class="n">reference</span><span class="p">[</span><span class="s2">&quot;potential_energy&quot;</span><span class="p">],</span>
            <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-10</span>
        <span class="p">)</span>

        <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span>
            <span class="n">kinetic_energy</span><span class="p">,</span>
            <span class="n">reference</span><span class="p">[</span><span class="s2">&quot;kinetic_energy&quot;</span><span class="p">],</span>
            <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-10</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_trajectory_reproducibility</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that simulations are reproducible.&quot;&quot;&quot;</span>
        <span class="c1"># Run same simulation twice with same seed</span>
        <span class="n">results1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_reference_simulation</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>
        <span class="n">results2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_reference_simulation</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">12345</span><span class="p">)</span>

        <span class="c1"># Trajectories should be identical</span>
        <span class="n">traj1</span> <span class="o">=</span> <span class="n">results1</span><span class="o">.</span><span class="n">load_trajectory</span><span class="p">()</span>
        <span class="n">traj2</span> <span class="o">=</span> <span class="n">results2</span><span class="o">.</span><span class="n">load_trajectory</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">frame1</span><span class="p">,</span> <span class="n">frame2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">traj1</span><span class="p">,</span> <span class="n">traj2</span><span class="p">):</span>
            <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span>
                <span class="n">frame1</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span>
                <span class="n">frame2</span><span class="o">.</span><span class="n">coordinates</span>
            <span class="p">)</span>
</pre></div>
</div>
<p><strong>4. Performance Tests</strong></p>
<p>Monitor performance characteristics:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.testing</span><span class="w"> </span><span class="kn">import</span> <span class="n">BenchmarkCase</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">PerformanceProfiler</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TestPerformanceBenchmarks</span><span class="p">(</span><span class="n">BenchmarkCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Performance benchmark tests.&quot;&quot;&quot;</span>

    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">performance</span>
    <span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">&quot;system_size&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">50000</span><span class="p">])</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_simulation_performance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_size</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Benchmark simulation performance for different system sizes.&quot;&quot;&quot;</span>
        <span class="c1"># Create test system</span>
        <span class="n">system</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_benchmark_system</span><span class="p">(</span><span class="n">n_atoms</span><span class="o">=</span><span class="n">system_size</span><span class="p">)</span>
        <span class="n">simulation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_benchmark_simulation</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>

        <span class="c1"># Warm up</span>
        <span class="n">simulation</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

        <span class="c1"># Benchmark</span>
        <span class="n">profiler</span> <span class="o">=</span> <span class="n">PerformanceProfiler</span><span class="p">()</span>

        <span class="k">with</span> <span class="n">profiler</span><span class="p">:</span>
            <span class="n">simulation</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

        <span class="c1"># Check performance metrics</span>
        <span class="n">ns_per_day</span> <span class="o">=</span> <span class="n">profiler</span><span class="o">.</span><span class="n">get_ns_per_day</span><span class="p">()</span>

        <span class="c1"># Store benchmark result</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">record_benchmark</span><span class="p">(</span>
            <span class="n">test_name</span><span class="o">=</span><span class="s2">&quot;simulation_performance&quot;</span><span class="p">,</span>
            <span class="n">system_size</span><span class="o">=</span><span class="n">system_size</span><span class="p">,</span>
            <span class="n">ns_per_day</span><span class="o">=</span><span class="n">ns_per_day</span>
        <span class="p">)</span>

        <span class="c1"># Performance should meet minimum requirements</span>
        <span class="n">min_performance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_minimum_performance</span><span class="p">(</span><span class="n">system_size</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">ns_per_day</span> <span class="o">&gt;=</span> <span class="n">min_performance</span>
</pre></div>
</div>
</section>
</section>
<section id="test-utilities">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Test Utilities</a><a class="headerlink" href="#test-utilities" title="Link to this heading">¶</a></h2>
<section id="test-framework-classes">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Test Framework Classes</a><a class="headerlink" href="#test-framework-classes" title="Link to this heading">¶</a></h3>
<p><strong>Base Test Case</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">unittest</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TestCase</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enhanced test case for ProteinMD.&quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUpClass</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up test class.&quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">test_data_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">temp_dir</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up individual test.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addCleanup</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cleanup_temp_dir</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_cleanup_temp_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clean up temporary directory.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_dir</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_dir</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">assertArrayAlmostEqual</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">array1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">array2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">decimal</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">7</span><span class="p">,</span>
        <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assert two arrays are almost equal.&quot;&quot;&quot;</span>
        <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_almost_equal</span><span class="p">(</span>
            <span class="n">array1</span><span class="p">,</span> <span class="n">array2</span><span class="p">,</span> <span class="n">decimal</span><span class="o">=</span><span class="n">decimal</span><span class="p">,</span> <span class="n">err_msg</span><span class="o">=</span><span class="n">msg</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">assertSystemEqual</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">system1</span><span class="p">,</span>
        <span class="n">system2</span><span class="p">,</span>
        <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-10</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assert two systems are equal within tolerance.&quot;&quot;&quot;</span>
        <span class="c1"># Compare coordinates</span>
        <span class="n">coords1</span> <span class="o">=</span> <span class="n">system1</span><span class="o">.</span><span class="n">get_coordinates</span><span class="p">()</span>
        <span class="n">coords2</span> <span class="o">=</span> <span class="n">system2</span><span class="o">.</span><span class="n">get_coordinates</span><span class="p">()</span>

        <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span>
            <span class="n">coords1</span><span class="p">,</span> <span class="n">coords2</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">tolerance</span>
        <span class="p">)</span>

        <span class="c1"># Compare velocities</span>
        <span class="n">vel1</span> <span class="o">=</span> <span class="n">system1</span><span class="o">.</span><span class="n">get_velocities</span><span class="p">()</span>
        <span class="n">vel2</span> <span class="o">=</span> <span class="n">system2</span><span class="o">.</span><span class="n">get_velocities</span><span class="p">()</span>

        <span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span>
            <span class="n">vel1</span><span class="p">,</span> <span class="n">vel2</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">tolerance</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_temp_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.tmp&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create temporary file in test temp directory.&quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
        <span class="n">fd</span><span class="p">,</span> <span class="n">path</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">(</span><span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">temp_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Test System Factory</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProteinStructure</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.environment</span><span class="w"> </span><span class="kn">import</span> <span class="n">WaterModel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.forcefield</span><span class="w"> </span><span class="kn">import</span> <span class="n">AmberFF14SB</span>


<span class="k">class</span><span class="w"> </span><span class="nc">TestSystemFactory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Factory for creating standardized test systems.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">systems</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;small_protein&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_small_protein</span><span class="p">,</span>
            <span class="s2">&quot;water_box&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_water_box</span><span class="p">,</span>
            <span class="s2">&quot;harmonic_oscillator&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_harmonic_oscillator</span><span class="p">,</span>
            <span class="s2">&quot;lennard_jones&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_lennard_jones</span><span class="p">,</span>
            <span class="s2">&quot;protein_ligand&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_protein_ligand_complex</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">system_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create test system of specified type.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">system_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">systems</span><span class="p">:</span>
            <span class="n">available</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">systems</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown system type &#39;</span><span class="si">{</span><span class="n">system_type</span><span class="si">}</span><span class="s2">&#39;. &quot;</span>
                           <span class="sa">f</span><span class="s2">&quot;Available: </span><span class="si">{</span><span class="n">available</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">systems</span><span class="p">[</span><span class="n">system_type</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_small_protein</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create small test protein system.&quot;&quot;&quot;</span>
        <span class="c1"># Create minimal protein structure (e.g., polyalanine)</span>
        <span class="n">n_residues</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_residues&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

        <span class="n">protein</span> <span class="o">=</span> <span class="n">ProteinStructure</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_residues</span><span class="p">):</span>
            <span class="n">residue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_alanine_residue</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">protein</span><span class="o">.</span><span class="n">add_residue</span><span class="p">(</span><span class="n">residue</span><span class="p">)</span>

        <span class="c1"># Apply force field</span>
        <span class="n">forcefield</span> <span class="o">=</span> <span class="n">AmberFF14SB</span><span class="p">()</span>
        <span class="n">system</span> <span class="o">=</span> <span class="n">forcefield</span><span class="o">.</span><span class="n">create_system</span><span class="p">(</span><span class="n">protein</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">system</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_water_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create water box system.&quot;&quot;&quot;</span>
        <span class="n">box_size</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;box_size&quot;</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>  <span class="c1"># nm</span>
        <span class="n">water_model</span> <span class="o">=</span> <span class="n">WaterModel</span><span class="p">(</span><span class="s2">&quot;TIP3P&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">water_model</span><span class="o">.</span><span class="n">create_box</span><span class="p">(</span><span class="n">box_size</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_harmonic_oscillator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create harmonic oscillator for testing integrators.&quot;&quot;&quot;</span>
        <span class="n">n_particles</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;n_particles&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;spring_constant&quot;</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>  <span class="c1"># kJ/mol/nm²</span>

        <span class="c1"># Create simple harmonic system</span>
        <span class="n">system</span> <span class="o">=</span> <span class="n">HarmonicSystem</span><span class="p">(</span><span class="n">n_particles</span><span class="o">=</span><span class="n">n_particles</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>

        <span class="c1"># Set initial conditions</span>
        <span class="n">positions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_particles</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>
        <span class="n">velocities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n_particles</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>

        <span class="n">system</span><span class="o">.</span><span class="n">set_positions</span><span class="p">(</span><span class="n">positions</span><span class="p">)</span>
        <span class="n">system</span><span class="o">.</span><span class="n">set_velocities</span><span class="p">(</span><span class="n">velocities</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">system</span>
</pre></div>
</div>
<p><strong>Custom Assertions</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MDAssertions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Custom assertions for MD testing.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">assert_energy_conserved</span><span class="p">(</span>
        <span class="n">initial_energy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">final_energy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assert energy is conserved within tolerance.&quot;&quot;&quot;</span>
        <span class="n">energy_drift</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">final_energy</span> <span class="o">-</span> <span class="n">initial_energy</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">energy_drift</span> <span class="o">&gt;</span> <span class="n">tolerance</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Energy not conserved: drift = </span><span class="si">{</span><span class="n">energy_drift</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> kJ/mol &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(tolerance = </span><span class="si">{</span><span class="n">tolerance</span><span class="si">}</span><span class="s2"> kJ/mol)&quot;</span>
            <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">assert_temperature_stable</span><span class="p">(</span>
        <span class="n">temperatures</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">target_temperature</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">10.0</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assert temperature remains stable around target.&quot;&quot;&quot;</span>
        <span class="n">mean_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">temperatures</span><span class="p">)</span>
        <span class="n">temp_deviation</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">mean_temp</span> <span class="o">-</span> <span class="n">target_temperature</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">temp_deviation</span> <span class="o">&gt;</span> <span class="n">tolerance</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Temperature not stable: mean = </span><span class="si">{</span><span class="n">mean_temp</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> K, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;target = </span><span class="si">{</span><span class="n">target_temperature</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> K, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;deviation = </span><span class="si">{</span><span class="n">temp_deviation</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> K&quot;</span>
            <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">assert_trajectory_reasonable</span><span class="p">(</span><span class="n">trajectory</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Assert trajectory contains reasonable structures.&quot;&quot;&quot;</span>
        <span class="c1"># Check for NaN or infinite coordinates</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trajectory</span><span class="p">):</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">get_coordinates</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">coords</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NaN coordinates in frame </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">coords</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Infinite coordinates in frame </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Check for unreasonably large displacements</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">prev_coords</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_coordinates</span><span class="p">()</span>
                <span class="n">displacement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">coords</span> <span class="o">-</span> <span class="n">prev_coords</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">displacement</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>  <span class="c1"># 1 nm max displacement per frame</span>
                    <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Large displacement in frame </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">displacement</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> nm&quot;</span>
                    <span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="test-fixtures">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Test Fixtures</a><a class="headerlink" href="#test-fixtures" title="Link to this heading">¶</a></h2>
<section id="pytest-fixtures">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Pytest Fixtures</a><a class="headerlink" href="#pytest-fixtures" title="Link to this heading">¶</a></h3>
<p><strong>Common Fixtures</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># conftest.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tempfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="s2">&quot;session&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_data_dir</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provide path to test data directory.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">temp_dir</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provide temporary directory for test files.&quot;&quot;&quot;</span>
    <span class="n">tmpdir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">())</span>
    <span class="k">yield</span> <span class="n">tmpdir</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">tmpdir</span><span class="p">)</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">small_protein</span><span class="p">(</span><span class="n">test_data_dir</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load small test protein.&quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProteinStructure</span>

    <span class="n">pdb_file</span> <span class="o">=</span> <span class="n">test_data_dir</span> <span class="o">/</span> <span class="s2">&quot;structures&quot;</span> <span class="o">/</span> <span class="s2">&quot;small_protein.pdb&quot;</span>
    <span class="k">return</span> <span class="n">ProteinStructure</span><span class="o">.</span><span class="n">from_pdb</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pdb_file</span><span class="p">))</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">water_system</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create water system for testing.&quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.testing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestSystemFactory</span>

    <span class="n">factory</span> <span class="o">=</span> <span class="n">TestSystemFactory</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">factory</span><span class="o">.</span><span class="n">create_system</span><span class="p">(</span><span class="s2">&quot;water_box&quot;</span><span class="p">,</span> <span class="n">box_size</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>


<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;amber&quot;</span><span class="p">,</span> <span class="s2">&quot;charmm&quot;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">forcefield</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parametrized fixture for different force fields.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">param</span> <span class="o">==</span> <span class="s2">&quot;amber&quot;</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.forcefield</span><span class="w"> </span><span class="kn">import</span> <span class="n">AmberFF14SB</span>
        <span class="k">return</span> <span class="n">AmberFF14SB</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">request</span><span class="o">.</span><span class="n">param</span> <span class="o">==</span> <span class="s2">&quot;charmm&quot;</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.forcefield</span><span class="w"> </span><span class="kn">import</span> <span class="n">CHARMM36</span>
        <span class="k">return</span> <span class="n">CHARMM36</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Performance Fixtures</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">performance_monitor</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fixture for performance monitoring.&quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">PerformanceMonitor</span>

    <span class="n">monitor</span> <span class="o">=</span> <span class="n">PerformanceMonitor</span><span class="p">()</span>
    <span class="n">monitor</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="k">yield</span> <span class="n">monitor</span>

    <span class="n">monitor</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">get_report</span><span class="p">()</span>

    <span class="c1"># Store performance data</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;performance_data.json&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
        <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">report</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Mock Fixtures</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mock_gpu</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mock GPU for testing GPU code without hardware.&quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">unittest.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">MagicMock</span>

    <span class="n">mock_gpu</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>
    <span class="n">mock_gpu</span><span class="o">.</span><span class="n">is_available</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">mock_gpu</span><span class="o">.</span><span class="n">get_device_count</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">mock_gpu</span><span class="o">.</span><span class="n">allocate_memory</span><span class="o">.</span><span class="n">return_value</span> <span class="o">=</span> <span class="n">MagicMock</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">mock_gpu</span>
</pre></div>
</div>
</section>
</section>
<section id="test-configuration">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Test Configuration</a><a class="headerlink" href="#test-configuration" title="Link to this heading">¶</a></h2>
<section id="pytest-configuration">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Pytest Configuration</a><a class="headerlink" href="#pytest-configuration" title="Link to this heading">¶</a></h3>
<p><strong>pytest.ini</strong></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[tool:pytest]</span>
<span class="na">minversion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">6.0</span>
<span class="na">addopts</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">-ra</span>
<span class="w">    </span><span class="na">--strict-markers</span>
<span class="w">    </span><span class="na">--strict-config</span>
<span class="w">    </span><span class="na">--cov</span><span class="o">=</span><span class="s">proteinmd</span>
<span class="w">    </span><span class="na">--cov-report</span><span class="o">=</span><span class="s">term-missing:skip-covered</span>
<span class="w">    </span><span class="na">--cov-report</span><span class="o">=</span><span class="s">html:htmlcov</span>
<span class="w">    </span><span class="na">--cov-report</span><span class="o">=</span><span class="s">xml</span>
<span class="na">testpaths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">tests</span>
<span class="na">markers</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">slow</span><span class="o">:</span><span class="w"> </span><span class="s">marks tests as slow (deselect with &#39;-m &quot;not slow&quot;&#39;)</span>
<span class="w">    </span><span class="na">performance</span><span class="o">:</span><span class="w"> </span><span class="s">marks tests as performance benchmarks</span>
<span class="w">    </span><span class="na">regression</span><span class="o">:</span><span class="w"> </span><span class="s">marks tests as regression tests</span>
<span class="w">    </span><span class="na">gpu</span><span class="o">:</span><span class="w"> </span><span class="s">marks tests that require GPU</span>
<span class="w">    </span><span class="na">integration</span><span class="o">:</span><span class="w"> </span><span class="s">marks tests as integration tests</span>
<span class="w">    </span><span class="na">unit</span><span class="o">:</span><span class="w"> </span><span class="s">marks tests as unit tests</span>
</pre></div>
</div>
<p><strong>Test Markers</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>


<span class="c1"># Mark slow tests</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">slow</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_long_simulation</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that takes a long time to run.&quot;&quot;&quot;</span>
    <span class="k">pass</span>


<span class="c1"># Mark GPU tests</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">gpu</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_gpu_acceleration</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that requires GPU hardware.&quot;&quot;&quot;</span>
    <span class="k">pass</span>


<span class="c1"># Skip tests based on conditions</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">skipif</span><span class="p">(</span>
    <span class="ow">not</span> <span class="n">gpu_available</span><span class="p">(),</span>
    <span class="n">reason</span><span class="o">=</span><span class="s2">&quot;GPU not available&quot;</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_cuda_kernels</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test CUDA kernels.&quot;&quot;&quot;</span>
    <span class="k">pass</span>


<span class="c1"># Parametrize tests</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">&quot;backend&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;openmm&quot;</span><span class="p">,</span> <span class="s2">&quot;gromacs&quot;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_backend_compatibility</span><span class="p">(</span><span class="n">backend</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test compatibility with different backends.&quot;&quot;&quot;</span>
    <span class="k">pass</span>
</pre></div>
</div>
</section>
</section>
<section id="continuous-integration">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Continuous Integration</a><a class="headerlink" href="#continuous-integration" title="Link to this heading">¶</a></h2>
<section id="github-actions-workflow">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">GitHub Actions Workflow</a><a class="headerlink" href="#github-actions-workflow" title="Link to this heading">¶</a></h3>
<p><strong>.github/workflows/tests.yml</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Tests</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">push</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">main</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">develop</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">pull_request</span><span class="p">:</span>
<span class="w">    </span><span class="nt">branches</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="nv">main</span><span class="w"> </span><span class="p p-Indicator">]</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ matrix.os }}</span>
<span class="w">    </span><span class="nt">strategy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">matrix</span><span class="p">:</span>
<span class="w">        </span><span class="nt">os</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">ubuntu-latest</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">windows-latest</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">macos-latest</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">3.8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3.9</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;3.10&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;3.11&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">exclude</span><span class="p">:</span>
<span class="w">          </span><span class="c1"># Exclude some combinations to reduce CI time</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">os</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">windows-latest</span>
<span class="w">            </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.8</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">os</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">macos-latest</span>
<span class="w">            </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3.8</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v3</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python ${{ matrix.python-version }}</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ matrix.python-version }}</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">python -m pip install --upgrade pip</span>
<span class="w">        </span><span class="no">pip install -r requirements-dev.txt</span>
<span class="w">        </span><span class="no">pip install -e .</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run unit tests</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">pytest tests/unit/ -v --cov=proteinmd</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run integration tests</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">pytest tests/integration/ -v -m &quot;not slow&quot;</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Upload coverage to Codecov</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">codecov/codecov-action@v3</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./coverage.xml</span>
<span class="w">        </span><span class="nt">flags</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unittests</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">codecov-umbrella</span>
</pre></div>
</div>
<p><strong>Performance Testing Workflow</strong></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Performance Tests</span>

<span class="nt">on</span><span class="p">:</span>
<span class="w">  </span><span class="nt">schedule</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">cron</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;0</span><span class="nv"> </span><span class="s">2</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">0&#39;</span><span class="w">  </span><span class="c1"># Weekly on Sunday at 2 AM</span>
<span class="w">  </span><span class="nt">workflow_dispatch</span><span class="p">:</span>

<span class="nt">jobs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">performance</span><span class="p">:</span>
<span class="w">    </span><span class="nt">runs-on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ubuntu-latest</span>

<span class="w">    </span><span class="nt">steps</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v3</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set up Python</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/setup-python@v4</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">python-version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3.10&quot;</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Install dependencies</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">pip install -r requirements-dev.txt</span>
<span class="w">        </span><span class="no">pip install -e .</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Run performance benchmarks</span>
<span class="w">      </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">pytest tests/performance/ -v --benchmark-json=benchmark.json</span>

<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Store benchmark results</span>
<span class="w">      </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">benchmark-action/github-action-benchmark@v1</span>
<span class="w">      </span><span class="nt">with</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tool</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;pytest&#39;</span>
<span class="w">        </span><span class="nt">output-file-path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">benchmark.json</span>
<span class="w">        </span><span class="nt">github-token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.GITHUB_TOKEN }}</span>
<span class="w">        </span><span class="nt">auto-push</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</section>
</section>
<section id="test-data-management">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Test Data Management</a><a class="headerlink" href="#test-data-management" title="Link to this heading">¶</a></h2>
<section id="test-data-organization">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Test Data Organization</a><a class="headerlink" href="#test-data-organization" title="Link to this heading">¶</a></h3>
<p><strong>Version Control Strategy</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Small test files (&lt; 1 MB) - store in git</span>
tests/data/structures/small_protein.pdb
tests/data/parameters/simple_forcefield.xml

<span class="c1"># Large test files - use Git LFS</span>
tests/data/trajectories/long_simulation.dcd
tests/data/structures/large_complex.pdb

<span class="c1"># Very large files - download on demand</span>
tests/data/download_large_files.py
</pre></div>
</div>
<p><strong>Test Data Generation</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># generate_test_data.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProteinStructure</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">proteinmd.testing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestSystemFactory</span>


<span class="k">def</span><span class="w"> </span><span class="nf">generate_small_protein</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate small protein for testing.&quot;&quot;&quot;</span>
    <span class="n">factory</span> <span class="o">=</span> <span class="n">TestSystemFactory</span><span class="p">()</span>
    <span class="n">protein</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">create_system</span><span class="p">(</span><span class="s2">&quot;small_protein&quot;</span><span class="p">,</span> <span class="n">n_residues</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">protein</span><span class="o">.</span><span class="n">to_pdb</span><span class="p">(</span><span class="s2">&quot;tests/data/structures/small_protein.pdb&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">generate_test_trajectory</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate test trajectory.&quot;&quot;&quot;</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">TestSystemFactory</span><span class="p">()</span><span class="o">.</span><span class="n">create_system</span><span class="p">(</span><span class="s2">&quot;water_box&quot;</span><span class="p">)</span>
    <span class="n">simulation</span> <span class="o">=</span> <span class="n">create_test_simulation</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>

    <span class="n">simulation</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">simulation</span><span class="o">.</span><span class="n">save_trajectory</span><span class="p">(</span><span class="s2">&quot;tests/data/trajectories/test_traj.dcd&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">generate_small_protein</span><span class="p">()</span>
    <span class="n">generate_test_trajectory</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="test-reporting">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Test Reporting</a><a class="headerlink" href="#test-reporting" title="Link to this heading">¶</a></h2>
<section id="coverage-reports">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Coverage Reports</a><a class="headerlink" href="#coverage-reports" title="Link to this heading">¶</a></h3>
<p><strong>Coverage Configuration</strong></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1"># .coveragerc</span>
<span class="k">[run]</span>
<span class="na">source</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">proteinmd</span>
<span class="na">omit</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">*/tests/*</span>
<span class="w">    </span><span class="na">*/setup.py</span>
<span class="w">    </span><span class="na">*/venv/*</span>
<span class="w">    </span><span class="na">*/__pycache__/*</span>

<span class="k">[report]</span>
<span class="na">exclude_lines</span><span class="w"> </span><span class="o">=</span>
<span class="w">    </span><span class="na">pragma</span><span class="o">:</span><span class="w"> </span><span class="s">no cover</span>
<span class="w">    </span><span class="na">def __repr__</span>
<span class="w">    </span><span class="na">if self.debug</span><span class="o">:</span>
<span class="w">    </span><span class="na">if settings.DEBUG</span>
<span class="w">    </span><span class="na">raise AssertionError</span>
<span class="w">    </span><span class="na">raise NotImplementedError</span>
<span class="w">    </span><span class="na">if 0</span><span class="o">:</span>
<span class="w">    </span><span class="na">if __name__</span><span class="w"> </span><span class="o">=</span><span class="s">= .__main__.:</span>

<span class="k">[html]</span>
<span class="na">directory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">htmlcov</span>
</pre></div>
</div>
<p><strong>Performance Reporting</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># performance_report.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>


<span class="k">class</span><span class="w"> </span><span class="nc">PerformanceReporter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate performance reports from benchmark data.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_file</span><span class="o">=</span><span class="s2">&quot;performance_data.json&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_data</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load performance data.&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;performance_reports&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate performance report.&quot;&quot;&quot;</span>
        <span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>
        <span class="n">output_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Plot performance trends</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_performance_trends</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="s2">&quot;trends.png&quot;</span><span class="p">)</span>

        <span class="c1"># Generate HTML report</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_generate_html_report</span><span class="p">(</span><span class="n">output_dir</span> <span class="o">/</span> <span class="s2">&quot;report.html&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_plot_performance_trends</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot performance trends over time.&quot;&quot;&quot;</span>
        <span class="c1"># Implementation for plotting</span>
        <span class="k">pass</span>
</pre></div>
</div>
</section>
</section>
<section id="best-practices">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">Best Practices</a><a class="headerlink" href="#best-practices" title="Link to this heading">¶</a></h2>
<section id="test-writing-guidelines">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Test Writing Guidelines</a><a class="headerlink" href="#test-writing-guidelines" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p><strong>Test Naming</strong>: Use descriptive names that explain what is being tested</p></li>
<li><p><strong>Test Organization</strong>: Group related tests in classes</p></li>
<li><p><strong>Setup/Teardown</strong>: Use appropriate setup and cleanup methods</p></li>
<li><p><strong>Assertions</strong>: Use specific assertions with clear error messages</p></li>
<li><p><strong>Test Data</strong>: Use minimal, focused test data</p></li>
<li><p><strong>Mocking</strong>: Mock external dependencies appropriately</p></li>
</ol>
<p><strong>Example Best Practices</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">TestRMSDCalculation</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test RMSD calculation functionality.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_rmsd_identical_structures_returns_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;RMSD of identical structures should be zero.&quot;&quot;&quot;</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">rmsd</span> <span class="o">=</span> <span class="n">calculate_rmsd</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">rmsd</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;RMSD of identical structures should be exactly zero&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">test_rmsd_with_known_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test RMSD calculation with known expected values.&quot;&quot;&quot;</span>
        <span class="c1"># Use simple, manually calculable case</span>
        <span class="n">coords1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
        <span class="n">coords2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

        <span class="n">expected_rmsd</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># All atoms displaced by 1 unit in z</span>
        <span class="n">actual_rmsd</span> <span class="o">=</span> <span class="n">calculate_rmsd</span><span class="p">(</span><span class="n">coords1</span><span class="p">,</span> <span class="n">coords2</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">actual_rmsd</span> <span class="o">-</span> <span class="n">expected_rmsd</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
</pre></div>
</div>
</section>
</section>
<section id="see-also">
<h2><a class="toc-backref" href="#id18" role="doc-backlink">See Also</a><a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="contributing.html"><span class="doc">Contributing to ProteinMD</span></a> - Contributing guidelines</p></li>
<li><p><a class="reference internal" href="architecture.html"><span class="doc">Software Architecture</span></a> - Software architecture</p></li>
<li><p><a class="reference internal" href="../api/index.html"><span class="doc">API Reference</span></a> - API reference for testing utilities</p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo" />
    
    <h1 class="logo logo-name">ProteinMD</h1>
    
  </a>
</p>



<p class="blurb">Molecular Dynamics Simulation Library</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=your-username&repo=proteinmd&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/user_manual.html">User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/cli_reference.html">CLI Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/core.html">Core Simulation Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/structure.html">Structure Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/forcefield.html">Force Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/environment.html">Environment Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/analysis.html">Analysis Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/sampling.html">Sampling Methods API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/visualization.html">Visualization Tools API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/utils.html">Utilities API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced/performance.html">Performance Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/validation.html">Validation and Quality Assurance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/extending.html">Extending ProteinMD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/troubleshooting.html">Troubleshooting Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Software Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to ProteinMD</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Testing Framework</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#test-organization">Test Organization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#test-utilities">Test Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#test-fixtures">Test Fixtures</a></li>
<li class="toctree-l2"><a class="reference internal" href="#test-configuration">Test Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#continuous-integration">Continuous Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#test-data-management">Test Data Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="#test-reporting">Test Reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#best-practices">Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="documentation.html">Documentation Guidelines</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/changelog.html#development-milestones">Development Milestones</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/changelog.html#release-notes-details">Release Notes Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/changelog.html#upcoming-releases">Upcoming Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/changelog.html#release-process">Release Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html">Citation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#primary-citation">Primary Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#component-specific-citations">Component-Specific Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#backend-dependencies">Backend Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#version-specific-citations">Version-Specific Citations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#contributing-authors">Contributing Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#citation-tools">Citation Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/citation.html#contact-for-citations">Contact for Citations</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://github.com/your-username/proteinmd">GitHub</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="contributing.html" title="previous chapter">Contributing to ProteinMD</a></li>
      <li>Next: <a href="documentation.html" title="next chapter">Documentation Guidelines</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, ProteinMD Development Team.
      
      |
      <a href="../_sources/developer/testing.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/your-username/proteinmd" class="github">
        <img src="../_static/github-banner.svg" alt="Fork me on GitHub" class="github"/>
    </a>
    

    
  </body>
</html>