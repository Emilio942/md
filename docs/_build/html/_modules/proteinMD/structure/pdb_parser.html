<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>proteinMD.structure.pdb_parser &#8212; ProteinMD 1.0.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/theme_overrides.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <script src="../../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for proteinMD.structure.pdb_parser</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">PDB file parser for protein structure processing.</span>

<span class="sd">This module provides classes and functions for reading and parsing </span>
<span class="sd">Protein Data Bank (PDB) files to create internal protein structure representations.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Set</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">gzip</span>
<span class="kn">from</span> <span class="nn">..structure.protein</span> <span class="kn">import</span> <span class="n">Atom</span><span class="p">,</span> <span class="n">Residue</span><span class="p">,</span> <span class="n">Chain</span><span class="p">,</span> <span class="n">Protein</span>

<span class="c1"># Configure logging</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Standard atomic masses for common elements (in atomic mass units)</span>
<span class="n">ATOMIC_MASSES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mf">1.008</span><span class="p">,</span> <span class="s1">&#39;HE&#39;</span><span class="p">:</span> <span class="mf">4.003</span><span class="p">,</span> <span class="s1">&#39;LI&#39;</span><span class="p">:</span> <span class="mf">6.941</span><span class="p">,</span> <span class="s1">&#39;BE&#39;</span><span class="p">:</span> <span class="mf">9.012</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mf">10.811</span><span class="p">,</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">12.011</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mf">14.007</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mf">15.999</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mf">18.998</span><span class="p">,</span> <span class="s1">&#39;NE&#39;</span><span class="p">:</span> <span class="mf">20.180</span><span class="p">,</span>
    <span class="s1">&#39;NA&#39;</span><span class="p">:</span> <span class="mf">22.990</span><span class="p">,</span> <span class="s1">&#39;MG&#39;</span><span class="p">:</span> <span class="mf">24.305</span><span class="p">,</span> <span class="s1">&#39;AL&#39;</span><span class="p">:</span> <span class="mf">26.982</span><span class="p">,</span> <span class="s1">&#39;SI&#39;</span><span class="p">:</span> <span class="mf">28.086</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="mf">30.974</span><span class="p">,</span>
    <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="mf">32.066</span><span class="p">,</span> <span class="s1">&#39;CL&#39;</span><span class="p">:</span> <span class="mf">35.453</span><span class="p">,</span> <span class="s1">&#39;AR&#39;</span><span class="p">:</span> <span class="mf">39.948</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="mf">39.098</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">:</span> <span class="mf">40.078</span><span class="p">,</span>
    <span class="s1">&#39;SC&#39;</span><span class="p">:</span> <span class="mf">44.956</span><span class="p">,</span> <span class="s1">&#39;TI&#39;</span><span class="p">:</span> <span class="mf">47.867</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="mf">50.942</span><span class="p">,</span> <span class="s1">&#39;CR&#39;</span><span class="p">:</span> <span class="mf">51.996</span><span class="p">,</span> <span class="s1">&#39;MN&#39;</span><span class="p">:</span> <span class="mf">54.938</span><span class="p">,</span>
    <span class="s1">&#39;FE&#39;</span><span class="p">:</span> <span class="mf">55.845</span><span class="p">,</span> <span class="s1">&#39;CO&#39;</span><span class="p">:</span> <span class="mf">58.933</span><span class="p">,</span> <span class="s1">&#39;NI&#39;</span><span class="p">:</span> <span class="mf">58.693</span><span class="p">,</span> <span class="s1">&#39;CU&#39;</span><span class="p">:</span> <span class="mf">63.546</span><span class="p">,</span> <span class="s1">&#39;ZN&#39;</span><span class="p">:</span> <span class="mf">65.39</span><span class="p">,</span>
    <span class="s1">&#39;GA&#39;</span><span class="p">:</span> <span class="mf">69.723</span><span class="p">,</span> <span class="s1">&#39;GE&#39;</span><span class="p">:</span> <span class="mf">72.61</span><span class="p">,</span> <span class="s1">&#39;AS&#39;</span><span class="p">:</span> <span class="mf">74.922</span><span class="p">,</span> <span class="s1">&#39;SE&#39;</span><span class="p">:</span> <span class="mf">78.96</span><span class="p">,</span> <span class="s1">&#39;BR&#39;</span><span class="p">:</span> <span class="mf">79.904</span><span class="p">,</span>
    <span class="s1">&#39;KR&#39;</span><span class="p">:</span> <span class="mf">83.80</span><span class="p">,</span> <span class="s1">&#39;RB&#39;</span><span class="p">:</span> <span class="mf">85.468</span><span class="p">,</span> <span class="s1">&#39;SR&#39;</span><span class="p">:</span> <span class="mf">87.62</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span> <span class="mf">88.906</span><span class="p">,</span> <span class="s1">&#39;ZR&#39;</span><span class="p">:</span> <span class="mf">91.224</span><span class="p">,</span>
    <span class="s1">&#39;NB&#39;</span><span class="p">:</span> <span class="mf">92.906</span><span class="p">,</span> <span class="s1">&#39;MO&#39;</span><span class="p">:</span> <span class="mf">95.94</span><span class="p">,</span> <span class="s1">&#39;TC&#39;</span><span class="p">:</span> <span class="mf">98.0</span><span class="p">,</span> <span class="s1">&#39;RU&#39;</span><span class="p">:</span> <span class="mf">101.07</span><span class="p">,</span> <span class="s1">&#39;RH&#39;</span><span class="p">:</span> <span class="mf">102.906</span><span class="p">,</span>
    <span class="s1">&#39;PD&#39;</span><span class="p">:</span> <span class="mf">106.42</span><span class="p">,</span> <span class="s1">&#39;AG&#39;</span><span class="p">:</span> <span class="mf">107.868</span><span class="p">,</span> <span class="s1">&#39;CD&#39;</span><span class="p">:</span> <span class="mf">112.411</span><span class="p">,</span> <span class="s1">&#39;IN&#39;</span><span class="p">:</span> <span class="mf">114.818</span><span class="p">,</span> <span class="s1">&#39;SN&#39;</span><span class="p">:</span> <span class="mf">118.711</span><span class="p">,</span>
    <span class="s1">&#39;SB&#39;</span><span class="p">:</span> <span class="mf">121.760</span><span class="p">,</span> <span class="s1">&#39;TE&#39;</span><span class="p">:</span> <span class="mf">127.60</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">:</span> <span class="mf">126.904</span><span class="p">,</span> <span class="s1">&#39;XE&#39;</span><span class="p">:</span> <span class="mf">131.29</span><span class="p">,</span> <span class="s1">&#39;CS&#39;</span><span class="p">:</span> <span class="mf">132.905</span><span class="p">,</span>
    <span class="s1">&#39;BA&#39;</span><span class="p">:</span> <span class="mf">137.327</span><span class="p">,</span> <span class="s1">&#39;LA&#39;</span><span class="p">:</span> <span class="mf">138.906</span><span class="p">,</span> <span class="s1">&#39;CE&#39;</span><span class="p">:</span> <span class="mf">140.116</span><span class="p">,</span> <span class="s1">&#39;PR&#39;</span><span class="p">:</span> <span class="mf">140.908</span><span class="p">,</span> <span class="s1">&#39;ND&#39;</span><span class="p">:</span> <span class="mf">144.24</span><span class="p">,</span>
    <span class="s1">&#39;PM&#39;</span><span class="p">:</span> <span class="mf">145.0</span><span class="p">,</span> <span class="s1">&#39;SM&#39;</span><span class="p">:</span> <span class="mf">150.36</span><span class="p">,</span> <span class="s1">&#39;EU&#39;</span><span class="p">:</span> <span class="mf">151.964</span><span class="p">,</span> <span class="s1">&#39;GD&#39;</span><span class="p">:</span> <span class="mf">157.25</span><span class="p">,</span> <span class="s1">&#39;TB&#39;</span><span class="p">:</span> <span class="mf">158.925</span><span class="p">,</span>
    <span class="s1">&#39;DY&#39;</span><span class="p">:</span> <span class="mf">162.50</span><span class="p">,</span> <span class="s1">&#39;HO&#39;</span><span class="p">:</span> <span class="mf">164.930</span><span class="p">,</span> <span class="s1">&#39;ER&#39;</span><span class="p">:</span> <span class="mf">167.26</span><span class="p">,</span> <span class="s1">&#39;TM&#39;</span><span class="p">:</span> <span class="mf">168.934</span><span class="p">,</span> <span class="s1">&#39;YB&#39;</span><span class="p">:</span> <span class="mf">173.04</span><span class="p">,</span>
    <span class="s1">&#39;LU&#39;</span><span class="p">:</span> <span class="mf">174.967</span><span class="p">,</span> <span class="s1">&#39;HF&#39;</span><span class="p">:</span> <span class="mf">178.49</span><span class="p">,</span> <span class="s1">&#39;TA&#39;</span><span class="p">:</span> <span class="mf">180.948</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">:</span> <span class="mf">183.84</span><span class="p">,</span> <span class="s1">&#39;RE&#39;</span><span class="p">:</span> <span class="mf">186.207</span><span class="p">,</span>
    <span class="s1">&#39;OS&#39;</span><span class="p">:</span> <span class="mf">190.23</span><span class="p">,</span> <span class="s1">&#39;IR&#39;</span><span class="p">:</span> <span class="mf">192.217</span><span class="p">,</span> <span class="s1">&#39;PT&#39;</span><span class="p">:</span> <span class="mf">195.078</span><span class="p">,</span> <span class="s1">&#39;AU&#39;</span><span class="p">:</span> <span class="mf">196.967</span><span class="p">,</span> <span class="s1">&#39;HG&#39;</span><span class="p">:</span> <span class="mf">200.59</span><span class="p">,</span>
    <span class="s1">&#39;TL&#39;</span><span class="p">:</span> <span class="mf">204.383</span><span class="p">,</span> <span class="s1">&#39;PB&#39;</span><span class="p">:</span> <span class="mf">207.2</span><span class="p">,</span> <span class="s1">&#39;BI&#39;</span><span class="p">:</span> <span class="mf">208.980</span><span class="p">,</span> <span class="s1">&#39;PO&#39;</span><span class="p">:</span> <span class="mf">209.0</span><span class="p">,</span> <span class="s1">&#39;AT&#39;</span><span class="p">:</span> <span class="mf">210.0</span><span class="p">,</span>
    <span class="s1">&#39;RN&#39;</span><span class="p">:</span> <span class="mf">222.0</span><span class="p">,</span> <span class="s1">&#39;FR&#39;</span><span class="p">:</span> <span class="mf">223.0</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">:</span> <span class="mf">226.0</span><span class="p">,</span> <span class="s1">&#39;AC&#39;</span><span class="p">:</span> <span class="mf">227.0</span><span class="p">,</span> <span class="s1">&#39;TH&#39;</span><span class="p">:</span> <span class="mf">232.038</span><span class="p">,</span>
    <span class="s1">&#39;PA&#39;</span><span class="p">:</span> <span class="mf">231.036</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="mf">238.029</span><span class="p">,</span> <span class="s1">&#39;NP&#39;</span><span class="p">:</span> <span class="mf">237.0</span><span class="p">,</span> <span class="s1">&#39;PU&#39;</span><span class="p">:</span> <span class="mf">244.0</span><span class="p">,</span> <span class="s1">&#39;AM&#39;</span><span class="p">:</span> <span class="mf">243.0</span><span class="p">,</span>
    <span class="s1">&#39;CM&#39;</span><span class="p">:</span> <span class="mf">247.0</span><span class="p">,</span> <span class="s1">&#39;BK&#39;</span><span class="p">:</span> <span class="mf">247.0</span><span class="p">,</span> <span class="s1">&#39;CF&#39;</span><span class="p">:</span> <span class="mf">251.0</span><span class="p">,</span> <span class="s1">&#39;ES&#39;</span><span class="p">:</span> <span class="mf">252.0</span><span class="p">,</span> <span class="s1">&#39;FM&#39;</span><span class="p">:</span> <span class="mf">257.0</span><span class="p">,</span>
    <span class="s1">&#39;MD&#39;</span><span class="p">:</span> <span class="mf">258.0</span><span class="p">,</span> <span class="s1">&#39;NO&#39;</span><span class="p">:</span> <span class="mf">259.0</span><span class="p">,</span> <span class="s1">&#39;LR&#39;</span><span class="p">:</span> <span class="mf">262.0</span><span class="p">,</span> <span class="s1">&#39;RF&#39;</span><span class="p">:</span> <span class="mf">261.0</span><span class="p">,</span> <span class="s1">&#39;DB&#39;</span><span class="p">:</span> <span class="mf">262.0</span><span class="p">,</span>
    <span class="s1">&#39;SG&#39;</span><span class="p">:</span> <span class="mf">266.0</span><span class="p">,</span> <span class="s1">&#39;BH&#39;</span><span class="p">:</span> <span class="mf">264.0</span><span class="p">,</span> <span class="s1">&#39;HS&#39;</span><span class="p">:</span> <span class="mf">277.0</span><span class="p">,</span> <span class="s1">&#39;MT&#39;</span><span class="p">:</span> <span class="mf">268.0</span><span class="p">,</span> <span class="s1">&#39;DS&#39;</span><span class="p">:</span> <span class="mf">281.0</span><span class="p">,</span>
    <span class="s1">&#39;RG&#39;</span><span class="p">:</span> <span class="mf">272.0</span><span class="p">,</span> <span class="s1">&#39;CN&#39;</span><span class="p">:</span> <span class="mf">285.0</span><span class="p">,</span> <span class="s1">&#39;NH&#39;</span><span class="p">:</span> <span class="mf">286.0</span><span class="p">,</span> <span class="s1">&#39;FL&#39;</span><span class="p">:</span> <span class="mf">289.0</span><span class="p">,</span> <span class="s1">&#39;MC&#39;</span><span class="p">:</span> <span class="mf">289.0</span><span class="p">,</span>
    <span class="s1">&#39;LV&#39;</span><span class="p">:</span> <span class="mf">293.0</span><span class="p">,</span> <span class="s1">&#39;TS&#39;</span><span class="p">:</span> <span class="mf">294.0</span><span class="p">,</span> <span class="s1">&#39;OG&#39;</span><span class="p">:</span> <span class="mf">294.0</span>
<span class="p">}</span>

<span class="c1"># Standard residue mappings</span>
<span class="n">THREE_TO_ONE_LETTER</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;ALA&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;ARG&#39;</span><span class="p">:</span> <span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;ASN&#39;</span><span class="p">:</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">:</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;CYS&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GLN&#39;</span><span class="p">:</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;GLU&#39;</span><span class="p">:</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;GLY&#39;</span><span class="p">:</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;HIS&#39;</span><span class="p">:</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;ILE&#39;</span><span class="p">:</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span>
    <span class="s1">&#39;LEU&#39;</span><span class="p">:</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;LYS&#39;</span><span class="p">:</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;MET&#39;</span><span class="p">:</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;PHE&#39;</span><span class="p">:</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;PRO&#39;</span><span class="p">:</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SER&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;THR&#39;</span><span class="p">:</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;TRP&#39;</span><span class="p">:</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;TYR&#39;</span><span class="p">:</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;VAL&#39;</span><span class="p">:</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span>
    <span class="c1"># Non-standard amino acids</span>
    <span class="s1">&#39;ASX&#39;</span><span class="p">:</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;GLX&#39;</span><span class="p">:</span> <span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="s1">&#39;SEC&#39;</span><span class="p">:</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;PYL&#39;</span><span class="p">:</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;XLE&#39;</span><span class="p">:</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span>
    <span class="c1"># Nucleic acids</span>
    <span class="s1">&#39;DA&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;DT&#39;</span><span class="p">:</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;DG&#39;</span><span class="p">:</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;DC&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
    <span class="c1"># Unknown</span>
    <span class="s1">&#39;UNK&#39;</span><span class="p">:</span> <span class="s1">&#39;X&#39;</span>
<span class="p">}</span>

<div class="viewcode-block" id="PDBParser">
<a class="viewcode-back" href="../../../api/structure.html#proteinMD.structure.pdb_parser.PDBParser">[docs]</a>
<span class="k">class</span> <span class="nc">PDBParser</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parser for Protein Data Bank (PDB) files.</span>
<span class="sd">    </span>
<span class="sd">    This class provides methods for reading PDB files and creating</span>
<span class="sd">    internal protein structure representations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="PDBParser.__init__">
<a class="viewcode-back" href="../../../api/structure.html#proteinMD.structure.pdb_parser.PDBParser.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ignore_missing_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ignore_missing_residues</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a PDB parser.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ignore_missing_atoms : bool, optional</span>
<span class="sd">            Whether to ignore missing atoms in residues</span>
<span class="sd">        ignore_missing_residues : bool, optional</span>
<span class="sd">            Whether to ignore missing residues</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_missing_atoms</span> <span class="o">=</span> <span class="n">ignore_missing_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ignore_missing_residues</span> <span class="o">=</span> <span class="n">ignore_missing_residues</span></div>

    
<div class="viewcode-block" id="PDBParser.parse_file">
<a class="viewcode-back" href="../../../api/structure.html#proteinMD.structure.pdb_parser.PDBParser.parse_file">[docs]</a>
    <span class="k">def</span> <span class="nf">parse_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdb_path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Protein</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse a PDB file and return a Protein object.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pdb_path : str or Path</span>
<span class="sd">            Path to PDB file</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Protein</span>
<span class="sd">            Protein object containing the parsed data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pdb_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">pdb_path</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pdb_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PDB file not found: </span><span class="si">{</span><span class="n">pdb_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="c1"># Check if the file is gzipped</span>
        <span class="n">is_gzipped</span> <span class="o">=</span> <span class="n">pdb_path</span><span class="o">.</span><span class="n">suffix</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;.gz&#39;</span>
        
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parsing PDB file: </span><span class="si">{</span><span class="n">pdb_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_gzipped</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">pdb_path</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pdb_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error reading PDB file: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span>
            
        <span class="c1"># Get the PDB ID from the filename if possible</span>
        <span class="n">pdb_id</span> <span class="o">=</span> <span class="n">pdb_path</span><span class="o">.</span><span class="n">stem</span>
        <span class="k">if</span> <span class="n">pdb_id</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.pdb&#39;</span><span class="p">):</span>
            <span class="n">pdb_id</span> <span class="o">=</span> <span class="n">pdb_id</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">pdb_id</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="PDBParser.parse_lines">
<a class="viewcode-back" href="../../../api/structure.html#proteinMD.structure.pdb_parser.PDBParser.parse_lines">[docs]</a>
    <span class="k">def</span> <span class="nf">parse_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Protein</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse PDB lines and return a Protein object.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lines : list of str</span>
<span class="sd">            Lines from PDB file</span>
<span class="sd">        name : str</span>
<span class="sd">            Name of the protein (usually the PDB ID)</span>
<span class="sd">            </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Protein</span>
<span class="sd">            Protein object containing the parsed data</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Initialize protein object</span>
        <span class="n">protein</span> <span class="o">=</span> <span class="n">Protein</span><span class="p">(</span><span class="n">protein_id</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        
        <span class="c1"># Parse header information for metadata</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">experiment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">resolution</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">authors</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="n">chains</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Map chain_id to Chain object</span>
        <span class="n">residues</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Map (chain_id, residue_id) to Residue object</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Map atom_id to Atom object</span>
        
        <span class="c1"># First pass: extract metadata</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;TITLE&#39;</span><span class="p">):</span>
                <span class="n">title</span> <span class="o">+=</span> <span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;EXPDTA&#39;</span><span class="p">):</span>
                <span class="n">experiment</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;REMARK   2 RESOLUTION&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">res_part</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">res_part</span> <span class="ow">and</span> <span class="n">res_part</span> <span class="o">!=</span> <span class="s1">&#39;NOT APPLICABLE&#39;</span><span class="p">:</span>
                        <span class="n">resolution</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">res_part</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
                    <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;AUTHOR&#39;</span><span class="p">):</span>
                <span class="n">authors</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">auth</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">auth</span> <span class="ow">in</span> <span class="n">line</span><span class="p">[</span><span class="mi">10</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)])</span>
        
        <span class="n">protein</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>
        <span class="n">protein</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;experiment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">experiment</span>
        <span class="n">protein</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;resolution&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resolution</span>
        <span class="n">protein</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;authors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">authors</span><span class="p">)</span>
        
        <span class="c1"># Second pass: extract atoms, residues, and chains</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;ATOM&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;HETATM&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">atom_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="n">atom_name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">alt_loc</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># Alternate location indicator</span>
                    
                    <span class="c1"># Skip alternate locations other than &#39;&#39; or &#39;A&#39;</span>
                    <span class="k">if</span> <span class="n">alt_loc</span> <span class="ow">and</span> <span class="n">alt_loc</span> <span class="o">!=</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span>
                        <span class="k">continue</span>
                    
                    <span class="n">residue_name</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">chain_id</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">chain_id</span><span class="p">:</span>  <span class="c1"># Use space if no chain ID</span>
                        <span class="n">chain_id</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
                        
                    <span class="n">residue_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="n">insertion_code</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># Insertion code</span>
                    
                    <span class="k">if</span> <span class="n">insertion_code</span><span class="p">:</span>
                        <span class="c1"># Append insertion code to residue_id</span>
                        <span class="n">residue_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">residue_id</span><span class="si">}{</span><span class="n">insertion_code</span><span class="si">}</span><span class="s2">&quot;</span>
                    
                    <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">38</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="mi">46</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">46</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="n">position</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span> <span class="o">/</span> <span class="mf">10.0</span>  <span class="c1"># Convert from Angstroms to nm</span>
                    
                    <span class="n">occupancy</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">54</span><span class="p">:</span><span class="mi">60</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">54</span><span class="p">:</span><span class="mi">60</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">else</span> <span class="mf">1.0</span>
                    <span class="n">b_factor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">60</span><span class="p">:</span><span class="mi">66</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">60</span><span class="p">:</span><span class="mi">66</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">else</span> <span class="mf">0.0</span>
                    
                    <span class="c1"># Extract element and charge</span>
                    <span class="n">element</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">76</span><span class="p">:</span><span class="mi">78</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">element</span> <span class="ow">and</span> <span class="n">atom_name</span><span class="p">:</span>
                        <span class="c1"># Try to infer element from atom name</span>
                        <span class="n">element</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">atom_name</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">c</span><span class="o">.</span><span class="n">isdigit</span><span class="p">()])</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                        <span class="c1"># For most common atom names, first character is the element</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
                            <span class="n">element</span> <span class="o">=</span> <span class="n">element</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
                            <span class="n">element</span> <span class="o">=</span> <span class="n">element</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    
                    <span class="c1"># Get mass from element</span>
                    <span class="n">mass</span> <span class="o">=</span> <span class="n">ATOMIC_MASSES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="mf">0.0</span><span class="p">)</span>
                    
                    <span class="c1"># Determine charge (often blank in PDB files)</span>
                    <span class="n">charge</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Default to neutral</span>
                    <span class="n">charge_str</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">78</span><span class="p">:</span><span class="mi">80</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">charge_str</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">charge_str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]:</span>
                                <span class="c1"># Format like &#39;1+&#39;, &#39;2-&#39;</span>
                                <span class="n">charge_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">charge_str</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">charge_str</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">1</span>
                                <span class="n">charge</span> <span class="o">=</span> <span class="n">charge_val</span> <span class="k">if</span> <span class="n">charge_str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;+&#39;</span> <span class="k">else</span> <span class="o">-</span><span class="n">charge_val</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c1"># Format like &#39;1&#39;, &#39;-2&#39;</span>
                                <span class="n">charge</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">charge_str</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid charge format: </span><span class="si">{</span><span class="n">charge_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    
                    <span class="c1"># Create or get chain</span>
                    <span class="k">if</span> <span class="n">chain_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">chains</span><span class="p">:</span>
                        <span class="n">chain</span> <span class="o">=</span> <span class="n">Chain</span><span class="p">(</span><span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">)</span>
                        <span class="n">chains</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">chain</span>
                        <span class="n">protein</span><span class="o">.</span><span class="n">add_chain</span><span class="p">(</span><span class="n">chain</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">chain</span> <span class="o">=</span> <span class="n">chains</span><span class="p">[</span><span class="n">chain_id</span><span class="p">]</span>
                    
                    <span class="c1"># Create or get residue</span>
                    <span class="n">residue_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">chain_id</span><span class="p">,</span> <span class="n">residue_id</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">residue_key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
                        <span class="n">is_hetero</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;HETATM&#39;</span><span class="p">)</span>
                        <span class="n">residue</span> <span class="o">=</span> <span class="n">Residue</span><span class="p">(</span>
                            <span class="n">residue_id</span><span class="o">=</span><span class="n">residue_id</span><span class="p">,</span>
                            <span class="n">residue_name</span><span class="o">=</span><span class="n">residue_name</span><span class="p">,</span>
                            <span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">,</span>
                            <span class="n">insertion_code</span><span class="o">=</span><span class="n">insertion_code</span><span class="p">,</span>
                            <span class="n">is_hetero</span><span class="o">=</span><span class="n">is_hetero</span>
                        <span class="p">)</span>
                        <span class="n">residues</span><span class="p">[</span><span class="n">residue_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">residue</span>
                        <span class="n">chain</span><span class="o">.</span><span class="n">add_residue</span><span class="p">(</span><span class="n">residue</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">residue</span> <span class="o">=</span> <span class="n">residues</span><span class="p">[</span><span class="n">residue_key</span><span class="p">]</span>
                    
                    <span class="c1"># Create atom</span>
                    <span class="n">atom</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">(</span>
                        <span class="n">atom_id</span><span class="o">=</span><span class="n">atom_id</span><span class="p">,</span>
                        <span class="n">atom_name</span><span class="o">=</span><span class="n">atom_name</span><span class="p">,</span>
                        <span class="n">element</span><span class="o">=</span><span class="n">element</span><span class="p">,</span>
                        <span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span>
                        <span class="n">charge</span><span class="o">=</span><span class="n">charge</span><span class="p">,</span>
                        <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
                        <span class="n">residue_id</span><span class="o">=</span><span class="n">residue_id</span><span class="p">,</span>
                        <span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">,</span>
                        <span class="n">b_factor</span><span class="o">=</span><span class="n">b_factor</span><span class="p">,</span>
                        <span class="n">occupancy</span><span class="o">=</span><span class="n">occupancy</span>
                    <span class="p">)</span>
                    
                    <span class="n">atoms</span><span class="p">[</span><span class="n">atom_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">atom</span>
                    <span class="n">residue</span><span class="o">.</span><span class="n">add_atom</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
                    <span class="n">protein</span><span class="o">.</span><span class="n">_atoms</span><span class="p">[</span><span class="n">atom_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">atom</span>  <span class="c1"># Add directly to protein&#39;s atom dictionary</span>
                    <span class="n">protein</span><span class="o">.</span><span class="n">_atom_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error parsing atom line: </span><span class="si">{</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
            
            <span class="c1"># Parse CONECT records to establish bonds</span>
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;CONECT&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">atom_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">atom_id</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">:</span>
                            <span class="n">atom</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">atom_id</span><span class="p">]</span>
                            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)):</span>
                                <span class="k">try</span><span class="p">:</span>
                                    <span class="n">bonded_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                                    <span class="k">if</span> <span class="n">bonded_id</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">:</span>
                                        <span class="n">atom</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">bonded_id</span><span class="p">)</span>
                                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                                    <span class="k">continue</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error parsing CONECT line: </span><span class="si">{</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
                    
        <span class="c1"># Process secondary structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_secondary_structure</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">residues</span><span class="p">)</span>
        
        <span class="c1"># Add disulfide bonds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_process_disulfide_bonds</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">residues</span><span class="p">)</span>
        
        <span class="c1"># Check if any atoms or residues were found</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">atoms</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No atoms found in PDB file&quot;</span><span class="p">)</span>
        
        <span class="c1"># Calculate center of mass and other global properties</span>
        <span class="n">protein</span><span class="o">.</span><span class="n">calculate_properties</span><span class="p">()</span>
        
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parsed </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span><span class="si">}</span><span class="s2"> atoms, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">)</span><span class="si">}</span><span class="s2"> residues, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">chains</span><span class="p">)</span><span class="si">}</span><span class="s2"> chains&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">protein</span></div>

    
    <span class="k">def</span> <span class="nf">_process_secondary_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">residues</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="s1">&#39;Residue&#39;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process secondary structure information from HELIX and SHEET records.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;HELIX&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Extract helix information</span>
                    <span class="n">start_chain</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">19</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">start_res</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="n">end_chain</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">31</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">end_res</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">33</span><span class="p">:</span><span class="mi">37</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    
                    <span class="c1"># Assign alpha helix to residues in this range</span>
                    <span class="k">for</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">res_id</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">chain_id</span> <span class="o">==</span> <span class="n">start_chain</span> <span class="ow">and</span> <span class="n">chain_id</span> <span class="o">==</span> <span class="n">end_chain</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">start_res</span> <span class="o">&lt;=</span> <span class="n">res_id</span> <span class="o">&lt;=</span> <span class="n">end_res</span><span class="p">:</span>
                                <span class="n">residues</span><span class="p">[(</span><span class="n">chain_id</span><span class="p">,</span> <span class="n">res_id</span><span class="p">)]</span><span class="o">.</span><span class="n">secondary_structure</span> <span class="o">=</span> <span class="s1">&#39;H&#39;</span>  <span class="c1"># H for helix</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error parsing HELIX line: </span><span class="si">{</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
                    
            <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;SHEET&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Extract sheet information</span>
                    <span class="n">start_chain</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">start_res</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="n">end_chain</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">32</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">end_res</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">33</span><span class="p">:</span><span class="mi">37</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    
                    <span class="c1"># Assign beta sheet to residues in this range</span>
                    <span class="k">for</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">res_id</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">chain_id</span> <span class="o">==</span> <span class="n">start_chain</span> <span class="ow">and</span> <span class="n">chain_id</span> <span class="o">==</span> <span class="n">end_chain</span><span class="p">:</span>
                            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">start_res</span> <span class="o">&lt;=</span> <span class="n">res_id</span> <span class="o">&lt;=</span> <span class="n">end_res</span><span class="p">:</span>
                                <span class="n">residues</span><span class="p">[(</span><span class="n">chain_id</span><span class="p">,</span> <span class="n">res_id</span><span class="p">)]</span><span class="o">.</span><span class="n">secondary_structure</span> <span class="o">=</span> <span class="s1">&#39;E&#39;</span>  <span class="c1"># E for extended (sheet)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error parsing SHEET line: </span><span class="si">{</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">continue</span>
    
    <span class="k">def</span> <span class="nf">_process_disulfide_bonds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">atoms</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;Atom&#39;</span><span class="p">],</span> 
                                <span class="n">residues</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="s1">&#39;Residue&#39;</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process disulfide bond information from SSBOND records.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;SSBOND&#39;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Extract disulfide bond information</span>
                    <span class="n">first_chain</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">first_res</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">21</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="n">second_chain</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">29</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">second_res</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">31</span><span class="p">:</span><span class="mi">35</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    
                    <span class="c1"># Find the SG atoms in these cysteine residues</span>
                    <span class="n">sg1</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">sg2</span> <span class="o">=</span> <span class="kc">None</span>
                    
                    <span class="k">for</span> <span class="n">atom_id</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atoms</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">==</span> <span class="n">first_chain</span> <span class="ow">and</span> <span class="n">atom</span><span class="o">.</span><span class="n">residue_id</span> <span class="o">==</span> <span class="n">first_res</span> <span class="ow">and</span> <span class="n">atom</span><span class="o">.</span><span class="n">atom_name</span> <span class="o">==</span> <span class="s1">&#39;SG&#39;</span><span class="p">:</span>
                            <span class="n">sg1</span> <span class="o">=</span> <span class="n">atom</span>
                        <span class="k">elif</span> <span class="n">atom</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">==</span> <span class="n">second_chain</span> <span class="ow">and</span> <span class="n">atom</span><span class="o">.</span><span class="n">residue_id</span> <span class="o">==</span> <span class="n">second_res</span> <span class="ow">and</span> <span class="n">atom</span><span class="o">.</span><span class="n">atom_name</span> <span class="o">==</span> <span class="s1">&#39;SG&#39;</span><span class="p">:</span>
                            <span class="n">sg2</span> <span class="o">=</span> <span class="n">atom</span>
                    
                    <span class="c1"># Add bond between SG atoms</span>
                    <span class="k">if</span> <span class="n">sg1</span> <span class="ow">and</span> <span class="n">sg2</span><span class="p">:</span>
                        <span class="n">sg1</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">sg2</span><span class="o">.</span><span class="n">atom_id</span><span class="p">)</span>
                        <span class="n">sg2</span><span class="o">.</span><span class="n">add_bond</span><span class="p">(</span><span class="n">sg1</span><span class="o">.</span><span class="n">atom_id</span><span class="p">)</span>
                        
                        <span class="c1"># Mark residues as forming disulfide bond</span>
                        <span class="n">res1_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">first_chain</span><span class="p">,</span> <span class="n">first_res</span><span class="p">)</span>
                        <span class="n">res2_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">second_chain</span><span class="p">,</span> <span class="n">second_res</span><span class="p">)</span>
                        
                        <span class="k">if</span> <span class="n">res1_key</span> <span class="ow">in</span> <span class="n">residues</span> <span class="ow">and</span> <span class="n">res2_key</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
                            <span class="n">residues</span><span class="p">[</span><span class="n">res1_key</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;disulfide&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="n">residues</span><span class="p">[</span><span class="n">res2_key</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;disulfide&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error parsing SSBOND line: </span><span class="si">{</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">continue</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">ProteinMD</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide/quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide/cli_reference.html">CLI Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/core.html">Core Simulation Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/structure.html">Structure Handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/forcefield.html">Force Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/environment.html">Environment Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/analysis.html">Analysis Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/sampling.html">Sampling Methods API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/visualization.html">Visualization Tools API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/utils.html">Utilities API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, ProteinMD Development Team.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>